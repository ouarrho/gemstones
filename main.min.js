!function(){"use strict";var r={696:function(r,n,e){var t=this&&this.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(n,"__esModule",{value:!0}),n.Cuts=void 0;var i=t(e(367)),o=t(e(467)),a=t(e(725)),f=t(e(107)),c=t(e(686)),s=t(e(640)),u=t(e(418)),v=t(e(298)),l={"brilliant_cut.obj":i.default,"brilliant_cut_triangle.obj":o.default,"cube.obj":a.default,"oval_cut.obj":f.default,"pc40044.obj":c.default,"princess.obj":s.default,"sphere.obj":u.default,"step_cut.obj":v.default};n.Cuts=l},592:function(r,n,e){var t=this&&this.__createBinding||(Object.create?function(r,n,e,t){void 0===t&&(t=e);var i=Object.getOwnPropertyDescriptor(n,e);i&&!("get"in i?!n.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(r,t,i)}:function(r,n,e,t){void 0===t&&(t=e),r[t]=n[e]}),i=this&&this.__setModuleDefault||(Object.create?function(r,n){Object.defineProperty(r,"default",{enumerable:!0,value:n})}:function(r,n){r.default=n}),o=this&&this.__importStar||function(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var e in r)"default"!==e&&Object.prototype.hasOwnProperty.call(r,e)&&t(n,r,e);return i(n,r),n};Object.defineProperty(n,"__esModule",{value:!0}),n.Drawer=void 0;var a=e(62),f=e(841),c=e(61),s=e(817),u=o(e(71));e(457);var v=new Float32Array([-.5,-.5,-.5,-.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,.5,.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5,.5,-.5,-.5,.5,-.5]),l=function(){function r(r){var n=this;Page.Canvas.showLoader(!0),this.gl=r,this.cubeVBO=new a.VBO(r,v,3,r.FLOAT,!0),this.geometryVBO=r.createBuffer(),this.shader=new s.LazyShader(u.ShaderFrag,u.ShaderVert,"default shader"),this.shaderMulticolor=new s.LazyShader(u.ShaderMulticolorFrag,u.ShaderVert,"shader with dispersion"),this.raytracedVolumeShader=new s.LazyShader(u.RaytracedVolumeFrag,u.RaytracedVolumeVert,"debug raytraced shader"),this.normalsShader=new s.LazyShader(u.NormalsFrag,u.ShaderVert,"normals shader"),this.shadersSkybox=new s.LazyShader(u.SkyboxFrag,u.SkyboxVert,"skybox shader"),this.pMatrix=mat4.create(),this.mvpMatrix=mat4.create(),this.camera=new f.OrbitalCamera([0,0,0],1.5),this.camera.phi=1,this.camera.theta=2;var e=Math.PI-1e-4;function t(){var n=c.Parameters.backgroundColor;r.clearColor(n.r/255,n.g/255,n.b/255,.1)}Page.Canvas.Observers.mouseDrag.push((function(r,t){n.camera.theta-=3.14159*r,n.camera.phi-=3*t,n.camera.phi=Math.min(e,Math.max(1e-4,n.camera.phi)),n.updateMVPMatrix()})),Page.Canvas.Observers.mouseWheel.push((function(r){var e=n.camera.distance+.2*r;e=Math.min(8,Math.max(.8,e)),n.camera.distance=e,n.updateMVPMatrix()})),Page.Canvas.Observers.canvasResize.push((function(){n.updateMVPMatrix()})),c.Parameters.addCameraChangeObservers((function(){n.updateMVPMatrix()})),this.updateMVPMatrix(),r.enable(r.CULL_FACE),r.frontFace(r.CCW),r.cullFace(r.BACK),r.disable(r.DEPTH_TEST),r.disable(r.BLEND),c.Parameters.addBackgroundColorObserver(t),t(),c.Parameters.addRecomputeShaderObservers((function(){var r=n.computeInjectedInstructions();n.shader.reset(r)}))}return r.prototype.setGemstone=function(r){if(this.gemstone!==r){this.gemstone=r,this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.geometryVBO),this.gl.bufferData(this.gl.ARRAY_BUFFER,r.bufferData,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null);var n=this.computeInjectedInstructions();this.shader.reset(n),this.shaderMulticolor.reset(n),this.raytracedVolumeShader.reset(n),Page.Canvas.setIndicatorText("triangles-count-indicator",r.nbTriangles.toString()),Page.Canvas.setIndicatorText("facets-count-indicator",r.facets.length.toString());var e="shape_not_convex";this.gemstone.isConvex?Page.Demopage.setErrorMessage(e,""):Page.Demopage.setErrorMessage(e,"The current geometry is not supported. The simulation will not look as expected.")}},r.prototype.rotate=function(r){this.camera.theta+=r,this.updateMVPMatrix()},r.prototype.draw=function(){if(this.gl.clear(this.gl.COLOR_BUFFER_BIT),c.Parameters.displaySkybox&&this.drawSkybox(),this.gemstone){var r;if(c.Parameters.geometryOnly){if(!(r=this.normalsShader.shader))return}else{var n=c.Parameters.lightType===c.ELightType.ASET,e=c.Parameters.refractionIndex,t=c.Parameters.dispersion,i=Math.min(t,e-1);if(i<=0||n||c.Parameters.displayNormals){if(!(r=this.shader.shader))return;r.u.uRefractionIndex.value=c.Parameters.refractionIndex,r.u.uDisplayNormals.value=c.Parameters.displayNormals?1:0}else{if(!(r=this.shaderMulticolor.shader))return;r.u.uRefractionIndices.value=[e-.5*i,e,e+.5*i]}r.u.uEyePosition.value=this.camera.eyePos,r.u.uOrthographic.value=c.Parameters.projection===c.EProjection.ORTHOGRAPHIC?1:0,r.u.uLightType.value=c.Parameters.lightType,r.u.uLightDirection.value=c.Parameters.lightDirection===c.ELightDirection.DOWNWARD?1:-1,r.u.uHeadShadow.value=c.Parameters.headShadow;var o=Math.atan2(this.camera.eyePos[1],this.camera.eyePos[0]);if(r.u.uSkyboxHorizontalCorrection.value=[Math.cos(-o),Math.sin(-o),-Math.sin(-o),Math.cos(-o)],r.u.uDisplayReflection.value=c.Parameters.displayReflection?1:0,void 0!==r.u.uAbsorption){var a=c.Parameters.absorption,f=n?{r:250,g:250,b:250}:c.Parameters.gemColor;r.u.uAbsorption.value=[a*(1-f.r/255),a*(1-f.g/255),a*(1-f.b/255)]}}Page.Canvas.showLoader(!1),r.u.uMVPMatrix.value=this.mvpMatrix,r.use(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.geometryVBO);var s=r.a.aPosition.loc;this.gl.enableVertexAttribArray(s),this.gl.vertexAttribPointer(s,3,this.gl.FLOAT,!1,24,0);var u=r.a.aNormal.loc;this.gl.enableVertexAttribArray(u),this.gl.vertexAttribPointer(u,3,this.gl.FLOAT,!1,24,12),r.bindUniformsAndAttributes(),this.gl.drawArrays(this.gl.TRIANGLES,0,3*this.gemstone.nbTriangles)}},r.prototype.drawDebugVolume=function(){if(this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gemstone){var r=this.raytracedVolumeShader.shader;r&&(Page.Canvas.showLoader(!1),r.a.aPosition.VBO=this.cubeVBO,r.u.uMVPMatrix.value=this.mvpMatrix,r.u.uEyePosition.value=this.camera.eyePos,r.u.uOrthographic.value=c.Parameters.projection===c.EProjection.ORTHOGRAPHIC?1:0,r.use(),r.bindUniformsAndAttributes(),this.gl.drawArrays(this.gl.TRIANGLES,0,36))}},r.prototype.drawSkybox=function(){var r=this.shadersSkybox.shader;r&&(r.a.aPosition.VBO=this.cubeVBO,r.u.uMVPMatrix.value=this.mvpMatrix,r.u.uEyePosition.value=this.camera.eyePos,r.u.uOrthographic.value=c.Parameters.projection===c.EProjection.ORTHOGRAPHIC?1:0,r.u.uLightType.value=c.Parameters.lightType,r.u.uLightDirection.value=c.Parameters.lightDirection===c.ELightDirection.DOWNWARD?1:-1,r.u.uHeadShadow.value=c.Parameters.headShadow,r.use(),r.bindUniformsAndAttributes(),this.gl.drawArrays(this.gl.TRIANGLES,0,36))},r.prototype.updateMVPMatrix=function(){var r=Page.Canvas.getAspectRatio();if(c.Parameters.projection===c.EProjection.PERSPECTIVE)mat4.perspective(this.pMatrix,45,r,.1,50);else{var n=.5*this.camera.distance;mat4.ortho(this.pMatrix,-n*r,n*r,-n,n,.1,50)}mat4.multiply(this.mvpMatrix,this.pMatrix,this.camera.viewMatrix)},r.prototype.computeInjectedInstructions=function(){for(var r=[],n=[],e=[],t=[],i=0;i<this.gemstone.facets.length;i++){var o=this.gemstone.facets[i],a="FACET_".concat(i,"_POINT"),f="FACET_".concat(i,"_NORMAL");r.push("const vec3 ".concat(a," = vec3(").concat(o.point.x,",").concat(o.point.y,",").concat(o.point.z,");")),r.push("const vec3 ".concat(f," = vec3(").concat(o.normal.x,",").concat(o.normal.y,",").concat(o.normal.z,");")),n.push("computeIntersectionWithPlane(".concat(a,", ").concat(f,", eyePosition, fromEyeNormalized, theta, facetNormal);")),e.push("isInside(".concat(a,", ").concat(f,", entryPoint)")),t.push("checkNextInternalIntersection(".concat(a,", ").concat(f,", position, direction, theta, facetNormal);"))}return{FACETS_DEFINITION:r.join("\n"),COMPUTE_ENTRY_POINT:n.join("\n\t"),CHECK_IF_INSIDE:e.join(" && "),COMPUTE_INTERNAL_INTERSECTION:t.join("\n\t"),RAY_DEPTH:c.Parameters.rayDepth.toString()}},r}();n.Drawer=l},667:function(r,n,e){Object.defineProperty(n,"__esModule",{value:!0}),n.registerFrame=void 0,e(457);var t=0,i=performance.now();setInterval((function(){var r=performance.now(),n=1e3*t/(r-i);i=r,t=0,Page.Canvas.setIndicatorText("fps-indicator",Math.round(n).toString())}),500),n.registerFrame=function(){t++}},169:function(r,n,e){Object.defineProperty(n,"__esModule",{value:!0}),n.Gemstone=void 0;var t=e(11),i=e(61),o=e(696);function a(r){i.Parameters.verbose&&console.log("OBJ parsing:  ".concat(r))}e(457);var f={},c=function(){function r(n){r.mutualizeTrianglesVertices(n),this.nbTriangles=n.length,this.bufferData=r.buildBufferFromTriangles(n),this.facets=r.buildFacetsFromTriangles(n);for(var e=[],t=0,i=n;t<i.length;t++){var o=i[t];e.push(o.p1),e.push(o.p2),e.push(o.p3)}this.isConvex=r.checkConvexity(e,this.facets),this.isConvex||console.log("This shape is not convex :(.")}return r.loadGemstone=function(n){if("CUSTOM CUT"===n)return r.customCut();if(void 0===f[n]){var e=o.Cuts[n];if(!e)throw new Error('Unknown cut name "'.concat(n,'".'));f[n]=r.fromObj(e)}var t=f[n];if(!t)throw new Error('Unknown gemstone name "'.concat(n,'".'));return t},r.fromObj=function(n){for(var e=n.split("\n"),t=[],i=[],o=0;o<e.length;o++){var f=e[o].trim(),c=f.split(/\s+/),s=c[0];if("v"===s){if(!(c.length>=4)){a("Ignoring line ".concat(o," because it does not have enough items: '").concat(f,"'."));continue}t.push({x:parseFloat(c[1]),y:parseFloat(c[2]),z:parseFloat(c[3])})}else{if("f"!==s){a("Ignoring line ".concat(o,": '").concat(f,"'."));continue}if(!(c.length>=4)){a("Ignoring line ".concat(o," because only triangular faces are supported: '").concat(f,"'."));continue}for(var u=3;u<c.length;u++){for(var v=[+c[1].split("/")[0],+c[u-1].split("/")[0],+c[u].split("/")[0]],l=0,d=v;l<d.length;l++){var h=d[l];(h<1||h>=t.length)&&a("Ignoring line ".concat(o," because vertex index ").concat(h," is out of range: '").concat(f,"'."))}i.push({p1:t[v[0]-1],p2:t[v[1]-1],p3:t[v[2]-1]})}}}return new r(i)},r.customCut=function(){var n=r.computeBrilliantCut();return new r(n)},r.buildBufferFromTriangles=function(r){for(var n=new Float32Array(18*r.length),e=0,i=0,o=r;i<o.length;i++){var a=o[i],f=(0,t.computeTriangleNormal)(a);n[e++]=a.p1.x,n[e++]=a.p1.y,n[e++]=a.p1.z,n[e++]=f.x,n[e++]=f.y,n[e++]=f.z,n[e++]=a.p2.x,n[e++]=a.p2.y,n[e++]=a.p2.z,n[e++]=f.x,n[e++]=f.y,n[e++]=f.z,n[e++]=a.p3.x,n[e++]=a.p3.y,n[e++]=a.p3.z,n[e++]=f.x,n[e++]=f.y,n[e++]=f.z}return n},r.buildFacetsFromTriangles=function(r){for(var n=[],e=0,i=r;e<i.length;e++){for(var o=i[e],a=!1,f=0,c=n;f<c.length;f++){var s=c[f];if((0,t.isInPlane)(s,o.p1)&&(0,t.isInPlane)(s,o.p2)&&(0,t.isInPlane)(s,o.p3)){a=!0;break}}a||n.push((0,t.computePlaneFromTriangle)(o))}return n},r.checkConvexity=function(r,n){for(var e=0,i=r;e<i.length;e++){var o=i[e];if(!(0,t.isInsideVolume)(n,o))return!1}return!0},r.computeBrilliantCut=function(){for(var r=.5,n=i.Parameters.customCutPavillionHeight,e=i.Parameters.customCutPavillionRati,o=i.Parameters.customCutGirdleThickness,a=i.Parameters.customCutGirdleRoundess,f=i.Parameters.customCutCrownHeight,c=i.Parameters.customCutCrownRatio,s=i.Parameters.customCutCrownTable,u=o+f,v={x:0,y:0,z:-n},l=(0,t.cylindric)((1-e)*r/Math.cos(2*Math.PI/16),2*Math.PI/8,-n*e),d=(0,t.rotateZ)(l,-2*Math.PI/8),h=(0,t.cylindric)(r,4*Math.PI/16,0),g=(0,t.cylindric)(r,2*Math.PI/16,0),m=(0,t.cylindric)(r,0*Math.PI/16,0),p={x:h.x,y:h.y,z:o},b={x:g.x,y:g.y,z:o},y={x:m.x,y:m.y,z:o},P=(0,t.cylindric)(.5*(1*(1-c)+c*s)/Math.cos(2*Math.PI/16),2*Math.PI/8,o+c*f),x=(0,t.rotateZ)(P,-2*Math.PI/8),T=(0,t.cylindric)(.5*s,2*Math.PI/16,u),R=(0,t.cylindric)(.5*s,-2*Math.PI/16,u),_={x:0,y:0,z:u},C=(0,t.computePlaneFromTriangle)({p1:d,p3:m,p2:g}),E=(0,t.computePlaneFromTriangle)({p1:l,p3:g,p2:h}),O=(0,t.computePlaneFromTriangle)({p1:b,p3:y,p2:x}),S=(0,t.computePlaneFromTriangle)({p1:p,p3:b,p2:P}),I=[],F=0;F<2;F++)for(var N=0===F?C:E,A=0===F?O:S,z=0===F?d:l,M=0===F?x:P,D=a+2,w=2*Math.PI/16/(D-1),L=2*F*Math.PI/16,j=0;j<D-1;j++){var V=L+j*w,B=(0,t.computeIntersection)((0,t.cylindric)(r,V,0),{x:0,y:0,z:1},N),k=(0,t.computeIntersection)((0,t.cylindric)(r,V+w,0),{x:0,y:0,z:1},N),G=(0,t.computeIntersection)((0,t.cylindric)(r,V,0),{x:0,y:0,z:1},A),U=(0,t.computeIntersection)((0,t.cylindric)(r,V+w,0),{x:0,y:0,z:1},A);I.push({p1:z,p3:B,p2:k}),I.push({p1:k,p3:B,p2:G}),I.push({p1:k,p3:G,p2:U}),I.push({p1:M,p3:U,p2:G})}I.push({p1:v,p3:d,p2:g}),I.push({p1:v,p3:g,p2:l}),I.push({p1:T,p3:R,p2:_}),I.push({p1:T,p3:x,p2:R}),I.push({p1:b,p3:x,p2:T}),I.push({p1:b,p3:T,p2:P});for(var H=I.length,Y=1;Y<8;Y++)for(var W=0;W<H;W++)I.push({p1:(0,t.rotateZ)(I[W].p1,2*Y*Math.PI/8),p2:(0,t.rotateZ)(I[W].p2,2*Y*Math.PI/8),p3:(0,t.rotateZ)(I[W].p3,2*Y*Math.PI/8)});return I},r.mutualizeTrianglesVertices=function(r){var n=0,e={},t=Math.pow(10,8);function i(r){return Math.round(t*r)}function o(r){var t="".concat(i(r.x),"_").concat(i(r.y),"_").concat(i(r.z));return void 0===e[t]?e[t]=r:n++,e[t]}for(var f=0,c=r;f<c.length;f++){var s=c[f];s.p1=o(s.p1),s.p2=o(s.p2),s.p3=o(s.p3)}a("After mutualization: ".concat(Object.keys(e).length," vertices (saved ").concat(n," vertices)."))},r}();n.Gemstone=c},11:function(r,n){function e(r){var n,e,t,o,a=i(r.p2,r.p1),f=(e=i(r.p3,r.p1),{x:(n=a).y*e.z-n.z*e.y,y:n.z*e.x-n.x*e.z,z:n.x*e.y-n.y*e.x});return t=f,(o=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z))>0?(t.x/=o,t.y/=o,t.z/=o):(t.x=1,t.y=0,t.z=0),f}function t(r,n){return r.x*n.x+r.y*n.y+r.z*n.z}function i(r,n){return{x:r.x-n.x,y:r.y-n.y,z:r.z-n.z}}function o(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];for(var e={x:0,y:0,z:0},t=0,i=r;t<i.length;t++){var o=i[t];e.x+=o.x,e.y+=o.y,e.z+=o.z}var a=r.length;return e.x/=a,e.y/=a,e.z/=a,e}Object.defineProperty(n,"__esModule",{value:!0}),n.rotateZ=n.isInsideVolume=n.isInPlane=n.cylindric=n.computeTriangleNormal=n.computePlaneFromTriangle=n.computeIntersection=n.averagePoint=void 0,n.computeTriangleNormal=e,n.averagePoint=o,n.isInPlane=function(r,n){var e=i(n,r.point);return Math.abs(t(r.normal,e))<.001},n.isInsideVolume=function(r,n){for(var e=0,o=r;e<o.length;e++){var a=o[e],f=i(n,a.point);if(t(a.normal,f)>.001)return!1}return!0},n.rotateZ=function(r,n){var e=Math.cos(n),t=Math.sin(n);return{x:e*r.x-t*r.y,y:t*r.x+e*r.y,z:r.z}},n.cylindric=function(r,n,e){return{x:r*Math.cos(n),y:r*Math.sin(n),z:e}},n.computeIntersection=function(r,n,e){var o=t(n,e.normal);if(0!==o){var a=t(i(e.point,r),e.normal)/o;return{x:r.x+a*n.x,y:r.y+a*n.y,z:r.z+a*n.z}}return r},n.computePlaneFromTriangle=function(r){return{point:o(r.p1,r.p2,r.p3),normal:e(r)}}},753:function(r,n,e){Object.defineProperty(n,"__esModule",{value:!0}),n.gl=n.initGL=n.adjustSize=void 0,e(457);var t=null;n.gl=t,n.initGL=function(r){function e(r){Page.Demopage.setErrorMessage("webgl-support",r)}var i=Page.Canvas.getCanvas();if(n.gl=t=i.getContext("webgl",r),null==t){if(n.gl=t=i.getContext("experimental-webgl",r),null==t)return e("Your browser or device does not seem to support WebGL."),!1;e("Your browser or device only supports experimental WebGL.\nThe simulation may not run as expected.")}return t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.BLEND),t.clearColor(0,0,0,1),!0},n.adjustSize=function(r){void 0===r&&(r=!1);var n=r?window.devicePixelRatio:1,e=t.canvas,i=Math.floor(e.clientWidth*n),o=Math.floor(e.clientHeight*n);e.width===i&&e.height===o||(e.width=i,e.height=o)}},771:function(r,n){Object.defineProperty(n,"__esModule",{value:!0}),n.GLResource=void 0;var e=function(){function r(r){this._gl=r}return r.prototype.gl=function(){return this._gl},r}();n.GLResource=e},748:function(r,n,e){Object.defineProperty(n,"__esModule",{value:!0}),n.deleteShader=n.getShader=n.buildShader=void 0;var t=e(753),i=e(490),o={};n.getShader=function(r){return o[r].shader},n.buildShader=function(r){function n(n){return n.replace(/#INJECT\(([^)]*)\)/gm,(function(n,e){return r.injected[e]?r.injected[e]:n}))}var e=n(r.vertexSource),o=n(r.fragmentSource);return new i.Shader(t.gl,e,o)},n.deleteShader=function(r){if(void 0!==o[r]){var n=o[r].shader;null!==n&&n.freeGLResources(),delete o[r]}}},71:function(r,n,e){var t=this&&this.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(n,"__esModule",{value:!0}),n.SkyboxVert=n.SkyboxFrag=n.ShaderVert=n.ShaderFrag=n.ShaderMulticolorFrag=n.RaytracedVolumeVert=n.RaytracedVolumeFrag=n.NormalsFrag=n.PostProcessingFullscreenVert=n.PostProcessingDownsizingFrag=n.PostProcessingCompositingFrag=n.PostProcessingBlurFrag=void 0;var i=t(e(264));n.PostProcessingBlurFrag=i.default;var o=t(e(709));n.PostProcessingCompositingFrag=o.default;var a=t(e(848));n.PostProcessingDownsizingFrag=a.default;var f=t(e(420));n.PostProcessingFullscreenVert=f.default;var c=t(e(294));n.NormalsFrag=c.default;var s=t(e(210));n.RaytracedVolumeFrag=s.default;var u=t(e(399));n.RaytracedVolumeVert=u.default;var v=t(e(765)),l=t(e(682));n.ShaderVert=l.default;var d=t(e(176)),h=t(e(732)),g=t(e(368));n.SkyboxVert=g.default;var m=t(e(692)),p=h.default.replace('#include "_skybox.frag"',m.default);n.SkyboxFrag=p;var b=v.default.replace('#include "_skybox.frag"',m.default);n.ShaderFrag=b;var y=d.default.replace('#include "_skybox.frag"',m.default);n.ShaderMulticolorFrag=y},490:function(r,n,e){var t,i=this&&this.__extends||(t=function(r,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(r[e]=n[e])},t(r,n)},function(r,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=r}t(r,n),r.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});Object.defineProperty(n,"__esModule",{value:!0}),n.Shader=void 0;var o=e(771);function a(){alert("NOT IMPLEMENTED YET")}var f={35664:{str:"FLOAT_VEC2",binder:function(r,n,e){r.uniform2fv(n,e)}},35665:{str:"FLOAT_VEC3",binder:function(r,n,e){r.uniform3fv(n,e)}},35666:{str:"FLOAT_VEC4",binder:function(r,n,e){r.uniform4fv(n,e)}},35667:{str:"INT_VEC2",binder:function(r,n,e){r.uniform2iv(n,e)}},35668:{str:"INT_VEC3",binder:function(r,n,e){r.uniform3iv(n,e)}},35669:{str:"INT_VEC4",binder:function(r,n,e){r.uniform4iv(n,e)}},35670:{str:"BOOL",binder:function(r,n,e){r.uniform1i(n,+e)}},35671:{str:"BOOL_VEC2",binder:function(r,n,e){r.uniform2iv(n,e)}},35672:{str:"BOOL_VEC3",binder:function(r,n,e){r.uniform3iv(n,e)}},35673:{str:"BOOL_VEC4",binder:function(r,n,e){r.uniform4iv(n,e)}},35674:{str:"FLOAT_MAT2",binder:function(r,n,e){r.uniformMatrix2fv(n,!1,e)}},35675:{str:"FLOAT_MAT3",binder:function(r,n,e){r.uniformMatrix3fv(n,!1,e)}},35676:{str:"FLOAT_MAT4",binder:function(r,n,e){r.uniformMatrix4fv(n,!1,e)}},35678:{str:"SAMPLER_2D",binder:function(r,n,e,t){r.uniform1i(n,e),r.activeTexture(r["TEXTURE"+e]),r.bindTexture(r.TEXTURE_2D,t)}},35680:{str:"SAMPLER_CUBE",binder:function(r,n,e,t){r.uniform1i(n,e),r.activeTexture(r["TEXTURE"+e]),r.bindTexture(r.TEXTURE_CUBE_MAP,t)}},5120:{str:"BYTE",binder:a},5121:{str:"UNSIGNED_BYTE",binder:a},5122:{str:"SHORT",binder:a},5123:{str:"UNSIGNED_SHORT",binder:a},5124:{str:"INT",binder:function(r,n,e){Array.isArray(e)?r.uniform1iv(n,e):r.uniform1i(n,e)}},5125:{str:"UNSIGNED_INT",binder:a},5126:{str:"FLOAT",binder:function(r,n,e){Array.isArray(e)?r.uniform1fv(n,e):r.uniform1f(n,e)}}},c=function(r){function n(n,e,t){var i=this;function o(r,e){var t=n.createShader(r);return n.shaderSource(t,e),n.compileShader(t),n.getShaderParameter(t,n.COMPILE_STATUS)?t:(console.error(n.getShaderInfoLog(t)),console.log(e),n.deleteShader(t),null)}(i=r.call(this,n)||this).id=null,i.uCount=0,i.aCount=0;var a=o(n.VERTEX_SHADER,e),f=o(n.FRAGMENT_SHADER,t),c=n.createProgram();return n.attachShader(c,a),n.attachShader(c,f),n.linkProgram(c),n.getProgramParameter(c,n.LINK_STATUS)?(i.id=c,i.introspection()):(console.error(n.getProgramInfoLog(c)),n.deleteProgram(c)),i}return i(n,r),n.prototype.freeGLResources=function(){r.prototype.gl.call(this).deleteProgram(this.id),this.id=null},n.prototype.use=function(){r.prototype.gl.call(this).useProgram(this.id)},n.prototype.bindUniforms=function(){var n=this,e=r.prototype.gl.call(this),t=0;Object.keys(this.u).forEach((function(r){var i=n.u[r];if(null!==i.value)if(35678===i.type||35680===i.type){var o=t;f[i.type].binder(e,i.loc,o,i.value),t++}else f[i.type].binder(e,i.loc,i.value)}))},n.prototype.bindAttributes=function(){var r=this;Object.keys(this.a).forEach((function(n){var e=r.a[n];null!==e.VBO&&e.VBO.bind(e.loc)}))},n.prototype.bindUniformsAndAttributes=function(){this.bindUniforms(),this.bindAttributes()},n.prototype.introspection=function(){var n=r.prototype.gl.call(this);this.uCount=n.getProgramParameter(this.id,n.ACTIVE_UNIFORMS),this.u={};for(var e=0;e<this.uCount;e++){var t=n.getActiveUniform(this.id,e),i=t.name;this.u[i]={loc:n.getUniformLocation(this.id,i),size:t.size,type:t.type,value:null}}for(this.aCount=n.getProgramParameter(this.id,n.ACTIVE_ATTRIBUTES),this.a={},e=0;e<this.aCount;e++){var o=n.getActiveAttrib(this.id,e),a=o.name;this.a[a]={VBO:null,loc:n.getAttribLocation(this.id,a),size:o.size,type:o.type}}},n}(o.GLResource);n.Shader=c},62:function(r,n,e){var t,i=this&&this.__extends||(t=function(r,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(r[e]=n[e])},t(r,n)},function(r,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=r}t(r,n),r.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});Object.defineProperty(n,"__esModule",{value:!0}),n.VBO=void 0;var o,a=e(771);!function(r){r[r.DYNAMIC=0]="DYNAMIC",r[r.STATIC=1]="STATIC"}(o||(o={}));var f=function(r){function n(n,e,t,i,a){void 0===a&&(a=!0);var f=r.call(this,n)||this;return f.id=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,f.id),a?n.bufferData(n.ARRAY_BUFFER,e,n.STATIC_DRAW):n.bufferData(n.ARRAY_BUFFER,e,n.DYNAMIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),f.size=t,f.type=i,f.normalize=!1,f.stride=0,f.offset=0,f.usage=a?o.STATIC:o.DYNAMIC,f}return i(n,r),n.createQuad=function(r,e,t,i,o){return new n(r,new Float32Array([e,t,i,t,e,o,i,o]),2,r.FLOAT,!0)},n.prototype.freeGLResources=function(){this.gl().deleteBuffer(this.id),this.id=null},n.prototype.bind=function(n){var e=r.prototype.gl.call(this);e.enableVertexAttribArray(n),e.bindBuffer(e.ARRAY_BUFFER,this.id),e.vertexAttribPointer(n,this.size,this.type,this.normalize,this.stride,this.offset)},n.prototype.setData=function(n){var e=r.prototype.gl.call(this);e.bindBuffer(e.ARRAY_BUFFER,this.id),this.usage===o.STATIC?e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW):e.bufferData(e.ARRAY_BUFFER,n,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null)},n}(a.GLResource);n.VBO=f},883:function(r,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Viewport=void 0;var e=function(){function r(r,n,e,t){this.left=r,this.lower=n,this.width=e,this.height=t}return r.setFullCanvas=function(r){r.viewport(0,0,r.drawingBufferWidth,r.drawingBufferHeight)},r.prototype.set=function(r){r.viewport(this.lower,this.left,this.width,this.height)},r}();n.Viewport=e},817:function(r,n,e){var t=this&&this.__createBinding||(Object.create?function(r,n,e,t){void 0===t&&(t=e);var i=Object.getOwnPropertyDescriptor(n,e);i&&!("get"in i?!n.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(r,t,i)}:function(r,n,e,t){void 0===t&&(t=e),r[t]=n[e]}),i=this&&this.__setModuleDefault||(Object.create?function(r,n){Object.defineProperty(r,"default",{enumerable:!0,value:n})}:function(r,n){r.default=n}),o=this&&this.__importStar||function(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var e in r)"default"!==e&&Object.prototype.hasOwnProperty.call(r,e)&&t(n,r,e);return i(n,r),n};Object.defineProperty(n,"__esModule",{value:!0}),n.LazyShader=void 0;var a=o(e(748));e(457);var f=0,c=function(){function r(r,n,e){this._shader=null,this.fragmentShaderSource=r,this.vertexShaderSource=n,this.errorKey="shader_fail_".concat(f++),this.errorMessage="Failed to build the shader '".concat(e,"'."),this.injected={}}return Object.defineProperty(r.prototype,"shader",{get:function(){return this._shader||this.build(),this._shader},enumerable:!1,configurable:!0}),r.prototype.reset=function(r){this.injected=r,this._shader&&(this._shader.freeGLResources(),this._shader=null)},r.prototype.build=function(){var r=a.buildShader({fragmentSource:this.fragmentShaderSource,vertexSource:this.vertexShaderSource,injected:this.injected});null!==r?this._shader=r:Page.Demopage.setErrorMessage(this.errorKey,this.errorMessage)},r}();n.LazyShader=c},633:function(r,n,e){var t=this&&this.__createBinding||(Object.create?function(r,n,e,t){void 0===t&&(t=e);var i=Object.getOwnPropertyDescriptor(n,e);i&&!("get"in i?!n.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(r,t,i)}:function(r,n,e,t){void 0===t&&(t=e),r[t]=n[e]}),i=this&&this.__setModuleDefault||(Object.create?function(r,n){Object.defineProperty(r,"default",{enumerable:!0,value:n})}:function(r,n){r.default=n}),o=this&&this.__importStar||function(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var e in r)"default"!==e&&Object.prototype.hasOwnProperty.call(r,e)&&t(n,r,e);return i(n,r),n};Object.defineProperty(n,"__esModule",{value:!0});var a=o(e(753)),f=e(753),c=e(883),s=e(592),u=o(e(667)),v=e(169),l=e(61),d=e(513),h=e(532);e(457),function(){if((0,d.registerPolyfills)(),a.initGL({alpha:!1,antialias:!1,depth:!1,stencil:!1,preserveDrawingBuffer:!1})){var r=!0;l.Parameters.addCanvasResizeObservers((function(){r=!0}));var n=new s.Drawer(f.gl),e=new h.PostProcessing(f.gl);l.Parameters.addCutChangeObserver(i),i();var t=0;!function i(){var o=performance.now(),s=performance.now()-t;t=o,u.registerFrame(),r&&(a.adjustSize(l.Parameters.highDPI),c.Viewport.setFullCanvas(f.gl),r=!1),l.Parameters.autoRotate&&!Page.Canvas.isMouseDown()&&n.rotate(1e-4*s),l.Parameters.displayRaytracedVolume?n.drawDebugVolume():l.Parameters.postProcessing&&e.isReady()?(e.prepare(),n.draw(),e.apply()):n.draw(),requestAnimationFrame(i)}()}function i(){var r=v.Gemstone.loadGemstone(l.Parameters.cutName);n.setGemstone(r)}}()},841:function(r,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OrbitalCamera=void 0;var e=function(){function r(r,n){this._focus=r,this._distance=n,this._theta=0,this._phi=.01,this._eyePos=[0,0,0],this._viewMatrix=mat4.create(),this.recompute()}return Object.defineProperty(r.prototype,"focusPoint",{get:function(){return this._focus},set:function(r){this._focus=r,this.recompute()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"distance",{get:function(){return this._distance},set:function(r){this._distance=r,this.recompute()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"theta",{get:function(){return this._theta},set:function(r){this._theta=r,this.recompute()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"phi",{get:function(){return this._phi},set:function(r){this._phi=r,this.recompute()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"eyePos",{get:function(){return this._eyePos},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"viewMatrix",{get:function(){return this._viewMatrix},enumerable:!1,configurable:!0}),r.prototype.recompute=function(){var r=Math.sin,n=Math.cos;this._eyePos[0]=this.focusPoint[0]+this.distance*(r(this.phi)*n(this.theta)),this._eyePos[1]=this.focusPoint[1]+this.distance*(r(this.phi)*r(this.theta)),this._eyePos[2]=this.focusPoint[2]+this.distance*n(this.phi),this._viewMatrix=mat4.lookAt(this._viewMatrix,this.eyePos,this.focusPoint,[0,0,1])},r}();n.OrbitalCamera=e},457:function(){},61:function(r,n,e){Object.defineProperty(n,"__esModule",{value:!0}),n.Parameters=n.EProjection=n.ELightType=n.ELightDirection=void 0,e(457);var t,i,o,a="gem-cut-picker-id",f="gem-color-picker-id",c="ray-depth-range-id",s="display-skybox-checkbox-id",u="head-shadow-range-id",v="background-color-picker-id",l="projection-tabs-id",d="high-dpi-checkbox-id",h="light-type-tabs-id",g="display-indicators-checkbox-id",m="custom-cut-crown-height-range-id",p="custom-cut-crown-table-range-id",b="custom-cut-crown-ratio-range-id",y="custom-cut-girdle-thickness-range-id",P="custom-cut-girdle-roundness-range-id",x="custom-cut-pavillion-height-range-id",T="custom-cut-pavillion-ratio-range-id";function R(r){for(var n=0,e=r;n<e.length;n++)(0,e[n])()}!function(r){r[r.ASET=0]="ASET",r[r.RINGS=1]="RINGS",r[r.RANDOM=2]="RANDOM"}(t||(t={})),n.ELightType=t,function(r){r.DOWNWARD="downward",r.UPWARD="upward"}(i||(i={})),n.ELightDirection=i,function(r){r.PERSPECTIVE="perspective",r.ORTHOGRAPHIC="orthographic"}(o||(o={})),n.EProjection=o;var _=[],C=function(){R(_)};Page.Picker.addObserver(a,C),Page.Range.addLazyObserver(m,C),Page.Range.addLazyObserver(p,C),Page.Range.addLazyObserver(b,C),Page.Range.addLazyObserver(y,C),Page.Range.addLazyObserver(P,C),Page.Range.addLazyObserver(x,C),Page.Range.addLazyObserver(T,C);var E=[];Page.Range.addLazyObserver(c,(function(){R(E)}));var O=[],S=function(){R(O)};Page.Canvas.Observers.canvasResize.push(S),Page.Checkbox.addObserver(d,S);var I=[];Page.Tabs.addObserver(l,(function(){R(I)}));var F=[],N={r:0,g:0,b:0};function A(){var r=Page.ColorPicker.getValue(v);N.r=r.r,N.g=r.g,N.b=r.b,R(F)}Page.ColorPicker.addObserver(v,A),A();var z={r:0,g:0,b:0};function M(){var r=Page.ColorPicker.getValue(f);z.r=r.r,z.g=r.g,z.b=r.b}Page.ColorPicker.addObserver(f,M),M();var D=function(){function r(){}return Object.defineProperty(r,"cutName",{get:function(){return Page.Picker.getValue(a)},enumerable:!1,configurable:!0}),Object.defineProperty(r,"refractionIndex",{get:function(){return Page.Range.getValue("refraction-range-id")},enumerable:!1,configurable:!0}),Object.defineProperty(r,"displaySkybox",{get:function(){return Page.Checkbox.isChecked(s)},enumerable:!1,configurable:!0}),Object.defineProperty(r,"headShadow",{get:function(){return 1-.02*Page.Range.getValue(u)},enumerable:!1,configurable:!0}),Object.defineProperty(r,"backgroundColor",{get:function(){return N},enumerable:!1,configurable:!0}),Object.defineProperty(r,"gemColor",{get:function(){return z},enumerable:!1,configurable:!0}),Object.defineProperty(r,"absorption",{get:function(){return Page.Range.getValue("absorption-range-id")},enumerable:!1,configurable:!0}),Object.defineProperty(r,"dispersion",{get:function(){return Page.Range.getValue("dispersion-range-id")},enumerable:!1,configurable:!0}),Object.defineProperty(r,"rayDepth",{get:function(){return Math.ceil(Page.Range.getValue(c))},enumerable:!1,configurable:!0}),Object.defineProperty(r,"displayReflection",{get:function(){return Page.Checkbox.isChecked("reflection-checkbox-id")},enumerable:!1,configurable:!0}),Object.defineProperty(r,"displayRaytracedVolume",{get:function(){return Page.Checkbox.isChecked("raytraced-volume-checkbox-id")},enumerable:!1,configurable:!0}),Object.defineProperty(r,"displayNormals",{get:function(){return Page.Checkbox.isChecked("display-normals-checkbox-id")},enumerable:!1,configurable:!0}),Object.defineProperty(r,"verbose",{get:function(){return Page.Checkbox.isChecked("verbose-checkbox-id")},enumerable:!1,configurable:!0}),Object.defineProperty(r,"projection",{get:function(){return Page.Tabs.getValues(l)[0]},enumerable:!1,configurable:!0}),Object.defineProperty(r,"geometryOnly",{get:function(){return Page.Checkbox.isChecked("only-normals-checkbox-id")},enumerable:!1,configurable:!0}),Object.defineProperty(r,"autoRotate",{get:function(){return Page.Checkbox.isChecked("auto-rotate-checkbox-id")},enumerable:!1,configurable:!0}),Object.defineProperty(r,"postProcessing",{get:function(){return Page.Checkbox.isChecked("post-processing-checkbox-id")},enumerable:!1,configurable:!0}),Object.defineProperty(r,"highDPI",{get:function(){return Page.Checkbox.isChecked(d)},enumerable:!1,configurable:!0}),Object.defineProperty(r,"lightType",{get:function(){return+Page.Tabs.getValues(h)[0]},enumerable:!1,configurable:!0}),Object.defineProperty(r,"lightDirection",{get:function(){return Page.Tabs.getValues("light-direction-tabs-id")[0]},enumerable:!1,configurable:!0}),Object.defineProperty(r,"customCutCrownHeight",{get:function(){return Page.Range.getValue(m)},enumerable:!1,configurable:!0}),Object.defineProperty(r,"customCutCrownTable",{get:function(){return Page.Range.getValue(p)},enumerable:!1,configurable:!0}),Object.defineProperty(r,"customCutCrownRatio",{get:function(){return Page.Range.getValue(b)},enumerable:!1,configurable:!0}),Object.defineProperty(r,"customCutGirdleThickness",{get:function(){return Page.Range.getValue(y)},enumerable:!1,configurable:!0}),Object.defineProperty(r,"customCutGirdleRoundess",{get:function(){return Page.Range.getValue(P)},enumerable:!1,configurable:!0}),Object.defineProperty(r,"customCutPavillionHeight",{get:function(){return Page.Range.getValue(x)},enumerable:!1,configurable:!0}),Object.defineProperty(r,"customCutPavillionRati",{get:function(){return Page.Range.getValue(T)},enumerable:!1,configurable:!0}),r.addCutChangeObserver=function(r){_.push(r)},r.addBackgroundColorObserver=function(r){F.push(r)},r.addRecomputeShaderObservers=function(r){E.push(r)},r.addCanvasResizeObservers=function(r){O.push(r)},r.addCameraChangeObservers=function(r){I.push(r)},r}();function w(){Page.Sections.setVisibility("custom-cut-section","CUSTOM CUT"===D.cutName)}function L(){var r=Page.Checkbox.isChecked(g);Page.Canvas.setIndicatorsVisibility(r)}function j(){Page.Controls.setVisibility(v,!D.displaySkybox)}function V(){Page.Controls.setVisibility(u,D.lightType===t.RANDOM)}n.Parameters=D,D.addCutChangeObserver(w),w(),Page.Controls.setVisibility(d,window.devicePixelRatio>1),Page.Checkbox.addObserver(g,L),L(),Page.Checkbox.addObserver(s,j),j(),Page.Tabs.addObserver(h,V),V();var B=!1;"undefined"!=typeof URLSearchParams&&(B="1"===new URLSearchParams(window.location.search).get("debug")),Page.Sections.setVisibility("debug-section-id",B)},532:function(r,n,e){var t=this&&this.__createBinding||(Object.create?function(r,n,e,t){void 0===t&&(t=e);var i=Object.getOwnPropertyDescriptor(n,e);i&&!("get"in i?!n.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(r,t,i)}:function(r,n,e,t){void 0===t&&(t=e),r[t]=n[e]}),i=this&&this.__setModuleDefault||(Object.create?function(r,n){Object.defineProperty(r,"default",{enumerable:!0,value:n})}:function(r,n){r.default=n}),o=this&&this.__importStar||function(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var e in r)"default"!==e&&Object.prototype.hasOwnProperty.call(r,e)&&t(n,r,e);return i(n,r),n};Object.defineProperty(n,"__esModule",{value:!0}),n.PostProcessing=void 0;var a=o(e(71)),f=e(62),c=e(817),s=e(61),u=new Float32Array([-1,-1,1,-1,-1,1,1,1]),v=function(){function r(n){this.gl=n,this.squareVBO=new f.VBO(n,u,2,n.FLOAT,!0),this.downsizingShader=new c.LazyShader(a.PostProcessingDownsizingFrag,a.PostProcessingFullscreenVert,"post-processing downsizing"),this.blurShader=new c.LazyShader(a.PostProcessingBlurFrag,a.PostProcessingFullscreenVert,"post-processing blur"),this.blurShader.reset({BLUR_INSTRUCTIONS:r.buildGlowInstructions1D(3)}),this.compositingShader=new c.LazyShader(a.PostProcessingCompositingFrag,a.PostProcessingFullscreenVert,"post-processing downsizing"),this.fullSizeTexture=this.createTexture(),this.downsizedTexture=this.createTexture(),this.downsizedBlurredTexture=this.createTexture()}return r.prototype.isReady=function(){var r=!!this.downsizingShader.shader,n=!!this.blurShader.shader,e=!!this.compositingShader.shader;return r&&n&&e},r.prototype.prepare=function(){var r=1/(8*(s.Parameters.highDPI?window.devicePixelRatio:1));this.initializeTexture(this.fullSizeTexture,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.initializeTexture(this.downsizedTexture,r*this.fullSizeTexture.width,r*this.fullSizeTexture.height),this.initializeTexture(this.downsizedBlurredTexture,this.downsizedTexture.width,this.downsizedTexture.height),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.fullSizeTexture.framebuffer),this.gl.viewport(0,0,this.fullSizeTexture.width,this.fullSizeTexture.height),this.gl.clear(this.gl.COLOR_BUFFER_BIT)},r.prototype.apply=function(){var r=this.downsizingShader.shader,n=this.blurShader.shader,e=this.compositingShader.shader;r&&n&&e&&(r.a.aCorner.VBO=this.squareVBO,r.u.uTexture.value=this.fullSizeTexture.texture,r.use(),r.bindUniformsAndAttributes(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.downsizedTexture.framebuffer),this.gl.viewport(0,0,this.downsizedTexture.width,this.downsizedTexture.height),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),n.a.aCorner.VBO=this.squareVBO,n.u.uTexture.value=this.downsizedTexture.texture,n.u.uTexelSize.value=[1/this.downsizedTexture.width,1/this.downsizedTexture.height],n.use(),n.bindUniformsAndAttributes(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.downsizedBlurredTexture.framebuffer),this.gl.viewport(0,0,this.downsizedBlurredTexture.width,this.downsizedBlurredTexture.height),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),e.a.aCorner.VBO=this.squareVBO,e.u.uFullsizeTexture.value=this.fullSizeTexture.texture,e.u.uFullsizeTextureTexelSize.value=[1/this.fullSizeTexture.width,1/this.fullSizeTexture.height],e.u.uBlurredTexture.value=this.downsizedBlurredTexture.texture,e.use(),e.bindUniformsAndAttributes(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindTexture(this.gl.TEXTURE_2D,null))},r.prototype.initializeTexture=function(r,n,e){if(n=Math.ceil(n),e=Math.ceil(e),r.width!==n||r.height!==e){this.gl.bindTexture(this.gl.TEXTURE_2D,r.texture);var t=this.gl.RGBA;this.gl.texImage2D(this.gl.TEXTURE_2D,0,t,n,e,0,t,this.gl.UNSIGNED_BYTE,null),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,r.framebuffer),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,r.texture,0),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.bindTexture(this.gl.TEXTURE_2D,null),r.width=n,r.height=e}},r.prototype.createTexture=function(){return{texture:this.gl.createTexture(),framebuffer:this.gl.createFramebuffer(),width:-1,height:-1}},r.buildGlowInstructions1D=function(r){function n(r){return Math.exp(-r*r/128)/Math.sqrt(2*Math.PI*8*8)}for(var e=0,t=-r-.5;t<=r;t++)e+=n(t);var i=[];for(t=-r-.5;t<=r+.5;t++)i.push("blurred += ".concat(n(t)/e," * contribution(vec2(").concat(t,", ").concat(t,"));")),i.push("blurred += ".concat(n(t)/e," * contribution(vec2(").concat(t,", ").concat(-t,"));"));return i.push("blurred *= 0.5;"),i.push("blurred *= 0.5;"),i.join("\n\t")},r}();n.PostProcessing=v},513:function(r,n){Object.defineProperty(n,"__esModule",{value:!0}),n.registerPolyfills=void 0,n.registerPolyfills=function(){"function"!=typeof String.prototype.startsWith&&(console.log("Registering polyfill for '".concat("String.startsWith","'.")),String.prototype.startsWith=function(r){return 0===this.indexOf(r)})}},367:function(r){r.exports="v 0.000000 -0.000000 -0.425623\r\nv 0.231734 -0.095988 -0.203960\r\nv 0.344038 -0.344038 0.039752\r\nv 0.095988 -0.231734 -0.203959\r\nv 0.231734 0.095987 -0.203959\r\nv 0.486543 -0.000000 0.039752\r\nv 0.095988 0.231734 -0.203959\r\nv 0.344038 0.344038 0.039752\r\nv -0.095987 0.231734 -0.203959\r\nv 0.000000 0.486543 0.039752\r\nv -0.231734 0.095987 -0.203959\r\nv -0.344038 0.344038 0.039752\r\nv -0.095987 -0.231734 -0.203959\r\nv -0.344038 -0.344038 0.039752\r\nv -0.231734 -0.095988 -0.203959\r\nv 0.000000 -0.254121 0.278289\r\nv 0.000000 -0.344034 0.194309\r\nv 0.142502 -0.344030 0.193730\r\nv 0.179690 -0.179690 0.278289\r\nv 0.241995 -0.241995 0.195992\r\nv 0.344031 -0.142503 0.193729\r\nv 0.254121 -0.000000 0.278289\r\nv 0.344041 -0.000000 0.194303\r\nv 0.344031 0.142502 0.193729\r\nv 0.089845 0.216905 0.278289\r\nv 0.179690 0.179690 0.278289\r\nv 0.142502 0.344029 0.193730\r\nv 0.000000 0.254120 0.278289\r\nv 0.000000 0.344043 0.194300\r\nv -0.142502 0.344029 0.193731\r\nv -0.179690 0.179690 0.278289\r\nv -0.242001 0.242001 0.195983\r\nv -0.344027 0.142500 0.193733\r\nv -0.254120 -0.000000 0.278289\r\nv -0.344048 -0.000000 0.194296\r\nv -0.344027 -0.142501 0.193733\r\nv -0.179690 -0.179691 0.278289\r\nv -0.241999 -0.242000 0.195986\r\nv -0.142502 -0.344030 0.193730\r\nv 0.344034 -0.344034 0.061209\r\nv 0.186467 -0.450170 0.061210\r\nv 0.186469 -0.450175 0.039752\r\nv 0.486538 -0.000000 0.061209\r\nv 0.450170 -0.186467 0.061210\r\nv 0.450175 -0.186469 0.039752\r\nv 0.344034 0.344034 0.061209\r\nv 0.450170 0.186466 0.061210\r\nv 0.450175 0.186468 0.039752\r\nv 0.000000 0.486537 0.061209\r\nv 0.186467 0.450170 0.061210\r\nv 0.186469 0.450175 0.039752\r\nv -0.344034 0.344034 0.061209\r\nv -0.186466 0.450170 0.061210\r\nv -0.186469 0.450175 0.039752\r\nv -0.486538 -0.000000 0.061209\r\nv -0.450170 0.186466 0.061210\r\nv -0.450175 0.186468 0.039752\r\nv -0.486543 -0.000000 0.039752\r\nv -0.344034 -0.344034 0.061209\r\nv -0.450170 -0.186467 0.061210\r\nv -0.450175 -0.186469 0.039752\r\nv 0.000000 -0.486538 0.061209\r\nv -0.186466 -0.450170 0.061210\r\nv -0.186468 -0.450175 0.039752\r\nv 0.000000 -0.486543 0.039752\r\nv 0.241999 0.241999 0.195987\r\nv -0.216905 0.089844 0.278289\r\nv 0.000000 -0.000000 0.278289\r\nv -0.216905 -0.089845 0.278289\r\nv -0.089846 -0.216905 0.278289\r\nv 0.089845 -0.216906 0.278289\r\nv 0.216905 -0.089845 0.278289\r\nv 0.216905 0.089845 0.278289\r\nv -0.089845 0.216905 0.278289\r\n\r\nf 1 2 3 4\r\nf 1 5 6 2\r\nf 1 7 8 5\r\nf 1 9 10 7\r\nf 1 11 12 9\r\nf 1 13 14 15\r\nf 16 17 18\r\nf 19 20 21\r\nf 22 23 24\r\nf 25 26 27\r\nf 28 29 30\r\nf 31 32 33\r\nf 34 35 36\r\nf 37 38 39\r\nf 40 41 42 3\r\nf 43 44 45 6\r\nf 46 47 48 8\r\nf 49 50 51 10\r\nf 52 53 54 12\r\nf 55 56 57 58\r\nf 59 60 61 14\r\nf 62 63 64 65\r\nf 3 42 4\r\nf 62 65 42 41\r\nf 40 3 45 44\r\nf 43 6 48 47\r\nf 46 8 51 50\r\nf 49 10 54 53\r\nf 52 12 57 56\r\nf 55 58 61 60\r\nf 59 14 64 63\r\nf 42 65 4\r\nf 1 15 58 11\r\nf 65 13 1 4\r\nf 38 37 36\r\nf 17 16 39\r\nf 20 19 18\r\nf 44 43 21\r\nf 66 26 24\r\nf 29 28 27\r\nf 32 31 30\r\nf 35 34 33\r\nf 31 67 68\r\nf 67 34 68\r\nf 34 69 68\r\nf 69 37 68\r\nf 37 70 68\r\nf 70 16 68\r\nf 16 71 68\r\nf 71 19 68\r\nf 19 72 68\r\nf 72 22 68\r\nf 22 73 68\r\nf 73 26 68\r\nf 26 25 68\r\nf 25 28 68\r\nf 28 74 68\r\nf 74 31 68\r\nf 40 44 21\r\nf 43 47 24\r\nf 46 50 27\r\nf 28 25 27\r\nf 26 66 27\r\nf 27 50 49\r\nf 24 47 46\r\nf 23 22 21\r\nf 18 41 40\r\nf 26 73 24\r\nf 24 73 22\r\nf 22 72 21\r\nf 21 72 19\r\nf 19 71 18\r\nf 18 71 16\r\nf 16 70 39\r\nf 39 70 37\r\nf 37 69 36\r\nf 36 69 34\r\nf 34 67 33\r\nf 33 67 31\r\nf 31 74 30\r\nf 30 74 28\r\nf 49 53 30\r\nf 30 53 52\r\nf 52 56 33\r\nf 33 56 55\r\nf 55 60 36\r\nf 36 60 59\r\nf 59 63 39\r\nf 39 63 62\r\nf 62 41 18\r\nf 65 64 13\r\nf 13 64 14\r\nf 14 61 15\r\nf 15 61 58\r\nf 58 57 11\r\nf 11 57 12\r\nf 12 54 9\r\nf 9 54 10\r\nf 10 51 7\r\nf 7 51 8\r\nf 8 48 5\r\nf 5 48 6\r\nf 6 45 2\r\nf 2 45 3\r\nf 36 59 38\r\nf 38 59 39\r\nf 39 62 17\r\nf 17 62 18\r\nf 18 40 20\r\nf 20 40 21\r\nf 21 43 23\r\nf 23 43 24\r\nf 24 46 66\r\nf 66 46 27\r\nf 27 49 29\r\nf 29 49 30\r\nf 30 52 32\r\nf 32 52 33\r\nf 33 55 35\r\nf 35 55 36\r\n"},467:function(r){r.exports="v 0.000000 -0.317902 0.196962\r\nv 0.275311 0.158951 0.196962\r\nv -0.275311 0.158951 0.196962\r\nv 0.275311 0.158951 0.196962\r\nv 0.000000 0.302263 0.143798\r\nv -0.275311 0.158951 0.196962\r\nv 0.000000 0.302263 0.143798\r\nv 0.275311 0.158951 0.196962\r\nv 0.329347 0.254954 0.112500\r\nv 0.182744 0.410414 0.023684\r\nv 0.000000 0.302263 0.143798\r\nv 0.182744 0.410414 0.023684\r\nv -0.182744 0.410414 0.023684\r\nv -0.329347 0.254954 0.112500\r\nv 0.000000 0.302263 0.143798\r\nv -0.182744 0.410414 0.023684\r\nv -0.275311 0.158951 0.196962\r\nv -0.329347 0.254954 0.112500\r\nv -0.182744 0.410414 0.023684\r\nv -0.408747 0.316801 0.023684\r\nv -0.329347 0.254954 0.112500\r\nv -0.478731 0.195585 0.023684\r\nv -0.385470 0.157746 0.112500\r\nv -0.275311 0.158951 0.196962\r\nv -0.408747 0.316801 0.023684\r\nv -0.385470 0.157746 0.112500\r\nv -0.478731 0.195585 0.023684\r\nv -0.446801 -0.046946 0.023684\r\nv -0.261767 -0.151132 0.143798\r\nv -0.275311 0.158951 0.196962\r\nv -0.385470 0.157746 0.112500\r\nv -0.446801 -0.046946 0.023684\r\nv -0.261767 -0.151132 0.143798\r\nv -0.446801 -0.046946 0.023684\r\nv -0.264057 -0.363468 0.023684\r\nv -0.261767 -0.151132 0.143798\r\nv 0.000000 -0.317902 0.196962\r\nv -0.275311 0.158951 0.196962\r\nv 0.000000 -0.317902 0.196962\r\nv -0.261767 -0.151132 0.143798\r\nv -0.264057 -0.363468 0.023684\r\nv -0.056123 -0.412700 0.112499\r\nv -0.056123 -0.412700 0.112499\r\nv -0.264057 -0.363468 0.023684\r\nv -0.069984 -0.512385 0.023684\r\nv 0.069984 -0.512385 0.023684\r\nv 0.056123 -0.412700 0.112499\r\nv -0.056123 -0.412700 0.112499\r\nv -0.069984 -0.512385 0.023684\r\nv 0.000000 -0.317902 0.196962\r\nv 0.056123 -0.412700 0.112499\r\nv 0.069984 -0.512385 0.023684\r\nv 0.264057 -0.363468 0.023684\r\nv 0.261767 -0.151132 0.143798\r\nv 0.000000 -0.317902 0.196962\r\nv 0.056123 -0.412700 0.112499\r\nv 0.264057 -0.363468 0.023684\r\nv 0.261767 -0.151132 0.143798\r\nv 0.264057 -0.363468 0.023684\r\nv 0.446801 -0.046946 0.023684\r\nv 0.261767 -0.151132 0.143798\r\nv 0.275311 0.158951 0.196962\r\nv 0.000000 -0.317902 0.196962\r\nv 0.385470 0.157746 0.112500\r\nv 0.261767 -0.151132 0.143798\r\nv 0.446801 -0.046946 0.023684\r\nv 0.275311 0.158951 0.196962\r\nv 0.385470 0.157746 0.112500\r\nv 0.446801 -0.046946 0.023684\r\nv 0.478731 0.195585 0.023684\r\nv 0.478731 0.195585 0.023684\r\nv 0.408747 0.316801 0.023684\r\nv 0.329347 0.254954 0.112500\r\nv 0.275311 0.158951 0.196962\r\nv 0.385470 0.157746 0.112500\r\nv 0.329347 0.254954 0.112500\r\nv 0.408747 0.316801 0.023684\r\nv 0.182744 0.410414 0.023684\r\nv 0.478731 0.195585 0.023684\r\nv 0.478731 0.195585 0.005228\r\nv 0.408747 0.316801 0.005228\r\nv 0.408747 0.316801 0.023684\r\nv 0.182744 0.410414 0.005228\r\nv 0.182744 0.410414 0.023684\r\nv 0.408747 0.316801 0.023684\r\nv 0.408747 0.316801 0.005228\r\nv -0.182744 0.410414 0.005228\r\nv -0.182744 0.410414 0.023684\r\nv 0.182744 0.410414 0.023684\r\nv 0.182744 0.410414 0.005228\r\nv -0.408747 0.316801 0.005228\r\nv -0.408747 0.316801 0.023684\r\nv -0.182744 0.410414 0.023684\r\nv -0.182744 0.410414 0.005228\r\nv -0.478731 0.195585 0.005228\r\nv -0.478731 0.195585 0.023684\r\nv -0.408747 0.316801 0.023684\r\nv -0.408747 0.316801 0.005228\r\nv -0.446801 -0.046946 0.005228\r\nv -0.446801 -0.046946 0.023684\r\nv -0.478731 0.195585 0.023684\r\nv -0.478731 0.195585 0.005228\r\nv -0.264057 -0.363468 0.005227\r\nv -0.264057 -0.363468 0.023684\r\nv -0.446801 -0.046946 0.023684\r\nv -0.446801 -0.046946 0.005228\r\nv -0.264057 -0.363468 0.023684\r\nv -0.264057 -0.363468 0.005227\r\nv -0.069984 -0.512385 0.005227\r\nv -0.069984 -0.512385 0.023684\r\nv -0.069984 -0.512385 0.023684\r\nv -0.069984 -0.512385 0.005227\r\nv 0.069984 -0.512385 0.005227\r\nv 0.069984 -0.512385 0.023684\r\nv 0.069984 -0.512385 0.023684\r\nv 0.069984 -0.512385 0.005227\r\nv 0.264057 -0.363468 0.005227\r\nv 0.264057 -0.363468 0.023684\r\nv 0.264057 -0.363468 0.023684\r\nv 0.264057 -0.363468 0.005227\r\nv 0.446801 -0.046946 0.005228\r\nv 0.446801 -0.046946 0.023684\r\nv 0.446801 -0.046946 0.023684\r\nv 0.446801 -0.046946 0.005228\r\nv 0.478731 0.195585 0.005228\r\nv 0.478731 0.195585 0.023684\r\nv 0.231227 -0.133499 -0.143440\r\nv 0.446801 -0.046946 0.005228\r\nv 0.264057 -0.363468 0.005227\r\nv 0.231227 -0.133499 -0.143440\r\nv 0.000000 0.000000 -0.380454\r\nv 0.446801 -0.046946 0.005228\r\nv 0.251293 0.145084 -0.202138\r\nv 0.446801 -0.046946 0.005228\r\nv 0.000000 0.000000 -0.380454\r\nv 0.231227 -0.133499 -0.143440\r\nv 0.264057 -0.363468 0.005227\r\nv 0.000000 0.000000 -0.380454\r\nv 0.000000 -0.290168 -0.202138\r\nv 0.000000 0.000000 -0.380454\r\nv 0.264057 -0.363468 0.005227\r\nv 0.478731 0.195585 0.005228\r\nv 0.446801 -0.046946 0.005228\r\nv 0.251293 0.145084 -0.202138\r\nv 0.408747 0.316801 0.005228\r\nv 0.478731 0.195585 0.005228\r\nv 0.251293 0.145084 -0.202138\r\nv 0.408747 0.316801 0.005228\r\nv 0.251293 0.145084 -0.202138\r\nv 0.182744 0.410414 0.005228\r\nv 0.182744 0.410414 0.005228\r\nv 0.000000 0.266998 -0.143440\r\nv -0.182744 0.410414 0.005228\r\nv 0.000000 0.266998 -0.143440\r\nv 0.000000 0.000000 -0.380454\r\nv -0.182744 0.410414 0.005228\r\nv 0.000000 0.266998 -0.143440\r\nv 0.182744 0.410414 0.005228\r\nv 0.000000 0.000000 -0.380454\r\nv 0.251293 0.145084 -0.202138\r\nv 0.000000 0.000000 -0.380454\r\nv 0.182744 0.410414 0.005228\r\nv -0.251293 0.145084 -0.202138\r\nv -0.182744 0.410414 0.005228\r\nv 0.000000 0.000000 -0.380454\r\nv -0.408747 0.316801 0.005228\r\nv -0.182744 0.410414 0.005228\r\nv -0.251293 0.145084 -0.202138\r\nv -0.408747 0.316801 0.005228\r\nv -0.251293 0.145084 -0.202138\r\nv -0.478731 0.195585 0.005228\r\nv -0.478731 0.195585 0.005228\r\nv -0.251293 0.145084 -0.202138\r\nv -0.446801 -0.046946 0.005228\r\nv -0.251293 0.145084 -0.202138\r\nv 0.000000 0.000000 -0.380454\r\nv -0.446801 -0.046946 0.005228\r\nv -0.231227 -0.133499 -0.143440\r\nv -0.446801 -0.046946 0.005228\r\nv 0.000000 0.000000 -0.380454\r\nv -0.231227 -0.133499 -0.143440\r\nv -0.264057 -0.363468 0.005227\r\nv -0.446801 -0.046946 0.005228\r\nv 0.000000 -0.290168 -0.202138\r\nv -0.264057 -0.363468 0.005227\r\nv 0.000000 0.000000 -0.380454\r\nv -0.069984 -0.512385 0.005227\r\nv -0.264057 -0.363468 0.005227\r\nv 0.000000 -0.290168 -0.202138\r\nv 0.000000 -0.290168 -0.202138\r\nv 0.069984 -0.512385 0.005227\r\nv -0.069984 -0.512385 0.005227\r\nv 0.069984 -0.512385 0.005227\r\nv 0.000000 -0.290168 -0.202138\r\nv 0.264057 -0.363468 0.005227\r\nv -0.231227 -0.133499 -0.143440\r\nv 0.000000 0.000000 -0.380454\r\nv -0.264057 -0.363468 0.005227\r\n\r\nf 1 2 3\r\nf 4 5 6\r\nf 7 8 9\r\nf 9 10 7\r\nf 11 12 13\r\nf 14 15 16\r\nf 15 14 17\r\nf 18 19 20\r\nf 21 22 23\r\nf 24 21 23\r\nf 25 22 21\r\nf 26 27 28\r\nf 29 30 31\r\nf 31 32 29\r\nf 33 34 35\r\nf 36 37 38\r\nf 39 40 41\r\nf 41 42 39\r\nf 43 44 45\r\nf 46 47 48 49\r\nf 50 48 47\r\nf 51 52 53\r\nf 54 55 56\r\nf 56 57 54\r\nf 58 59 60\r\nf 61 62 63\r\nf 64 65 66\r\nf 65 64 67\r\nf 68 69 70\r\nf 71 72 73\r\nf 74 75 73\r\nf 71 73 75\r\nf 76 77 78\r\nf 79 80 81 82\r\nf 83 84 85 86\r\nf 87 88 89 90\r\nf 91 92 93 94\r\nf 95 96 97 98\r\nf 99 100 101 102\r\nf 103 104 105 106\r\nf 107 108 109 110\r\nf 111 112 113 114\r\nf 115 116 117 118\r\nf 119 120 121 122\r\nf 123 124 125 126\r\nf 127 128 129\r\nf 130 131 132\r\nf 133 134 135\r\nf 136 137 138\r\nf 139 140 141\r\nf 142 143 144\r\nf 145 146 147\r\nf 148 149 150\r\nf 151 152 153\r\nf 154 155 156\r\nf 157 158 159\r\nf 160 161 162\r\nf 163 164 165\r\nf 166 167 168\r\nf 169 170 171\r\nf 172 173 174\r\nf 175 176 177\r\nf 178 179 180\r\nf 181 182 183\r\nf 184 185 186\r\nf 187 188 189\r\nf 190 191 192\r\nf 193 194 195\r\nf 196 197 198\r\n"},725:function(r){r.exports="v 0.400000 0.400000 -0.400000\r\nv 0.400000 -0.400000 -0.400000\r\nv 0.400000 0.400000 0.400000\r\nv 0.400000 -0.400000 0.400000\r\nv -0.400000 0.400000 -0.400000\r\nv -0.400000 -0.400000 -0.400000\r\nv -0.400000 0.400000 0.400000\r\nv -0.400000 -0.400000 0.400000\r\n\r\nf 1 5 7 3\r\nf 4 3 7 8\r\nf 8 7 5 6\r\nf 6 2 4 8\r\nf 2 1 3 4\r\nf 6 5 1 2\r\n"},107:function(r){r.exports="v 0.344371 -0.335396 0.004841\r\nv 0.344371 -0.335396 -0.011026\r\nv 0.475424 -0.138776 -0.011026\r\nv 0.475424 -0.138776 0.004843\r\nv 0.233087 -0.365048 -0.003090\r\nv 0.177445 -0.379874 -0.003090\r\nv 0.177445 -0.379874 -0.007058\r\nv 0.233087 -0.365048 -0.007058\r\nv 0.233087 -0.365048 0.000878\r\nv 0.177445 -0.379874 0.000878\r\nv 0.288729 -0.350222 -0.003090\r\nv 0.288729 -0.350222 -0.007058\r\nv 0.288729 -0.350222 0.000878\r\nv 0.121803 -0.394700 -0.011026\r\nv 0.344371 -0.335396 -0.011026\r\nv 0.121803 -0.394700 0.004845\r\nv 0.344371 -0.335396 0.004841\r\nv -0.000767 -0.394700 -0.007058\r\nv -0.062052 -0.394700 -0.007058\r\nv -0.062052 -0.394700 -0.009042\r\nv -0.000767 -0.394700 -0.009042\r\nv 0.060518 -0.394700 -0.007058\r\nv 0.060518 -0.394700 -0.009042\r\nv 0.060518 -0.394700 0.002860\r\nv -0.000767 -0.394700 0.002860\r\nv -0.000767 -0.394700 0.000876\r\nv 0.060518 -0.394700 0.000876\r\nv -0.062052 -0.394700 0.002860\r\nv -0.062052 -0.394700 0.000876\r\nv -0.123337 -0.394700 -0.011026\r\nv 0.121803 -0.394700 -0.011026\r\nv -0.123337 -0.394700 0.004844\r\nv 0.121803 -0.394700 0.004845\r\nv -0.234621 -0.365048 -0.007059\r\nv -0.290263 -0.350222 -0.007058\r\nv -0.290263 -0.350222 -0.009042\r\nv -0.234621 -0.365048 -0.009042\r\nv -0.178979 -0.379874 -0.007059\r\nv -0.178979 -0.379874 -0.009042\r\nv -0.178979 -0.379874 0.002860\r\nv -0.234621 -0.365048 0.002860\r\nv -0.234621 -0.365048 0.000876\r\nv -0.178979 -0.379874 0.000876\r\nv -0.290263 -0.350222 0.002860\r\nv -0.290263 -0.350222 0.000876\r\nv -0.345905 -0.335396 -0.011026\r\nv -0.123337 -0.394700 -0.011026\r\nv -0.345905 -0.335396 0.004841\r\nv -0.123337 -0.394700 0.004844\r\nv -0.411432 -0.237086 0.000876\r\nv -0.378668 -0.286241 0.000876\r\nv -0.378668 -0.286241 0.002860\r\nv -0.411432 -0.237086 0.002860\r\nv -0.444195 -0.187931 0.000876\r\nv -0.444195 -0.187931 0.002860\r\nv -0.444195 -0.187931 -0.009042\r\nv -0.411431 -0.237086 -0.009042\r\nv -0.411431 -0.237086 -0.007059\r\nv -0.444195 -0.187931 -0.007059\r\nv -0.378668 -0.286241 -0.009042\r\nv -0.378668 -0.286241 -0.007059\r\nv -0.345905 -0.335396 0.004841\r\nv -0.476958 -0.138776 0.004844\r\nv -0.345905 -0.335396 -0.011026\r\nv -0.476958 -0.138776 -0.011026\r\nv -0.476958 -0.138776 -0.011026\r\nv -0.476958 -0.138776 0.004844\r\nv -0.476958 0.142960 0.004844\r\nv -0.476958 0.142960 -0.011026\r\nv 0.475424 -0.138776 -0.011026\r\nv 0.475424 0.142960 -0.011026\r\nv 0.475424 0.142960 0.004843\r\nv 0.475424 -0.138776 0.004843\r\nv 0.344371 0.339581 0.004841\r\nv 0.475424 0.142960 0.004843\r\nv 0.475424 0.142960 -0.011026\r\nv 0.344371 0.339581 -0.011026\r\nv 0.233087 0.369233 -0.003090\r\nv 0.233087 0.369233 -0.007058\r\nv 0.177445 0.384058 -0.007058\r\nv 0.177445 0.384058 -0.003090\r\nv 0.233087 0.369233 0.000878\r\nv 0.177445 0.384058 0.000878\r\nv 0.288729 0.354407 -0.003090\r\nv 0.288729 0.354407 -0.007058\r\nv 0.288729 0.354407 0.000878\r\nv 0.121803 0.398884 -0.011026\r\nv 0.344371 0.339581 -0.011026\r\nv 0.121803 0.398884 0.004846\r\nv 0.344371 0.339581 0.004841\r\nv -0.000767 0.398884 -0.007058\r\nv -0.000767 0.398884 -0.009042\r\nv -0.062052 0.398884 -0.009042\r\nv -0.062052 0.398884 -0.007058\r\nv 0.060518 0.398884 -0.007058\r\nv 0.060518 0.398884 -0.009042\r\nv 0.060518 0.398884 0.002860\r\nv 0.060518 0.398884 0.000877\r\nv -0.000767 0.398884 0.000877\r\nv -0.000767 0.398884 0.002860\r\nv -0.062052 0.398884 0.000877\r\nv -0.062052 0.398884 0.002860\r\nv -0.123337 0.398884 -0.011026\r\nv 0.121803 0.398884 -0.011026\r\nv -0.123337 0.398884 0.004844\r\nv 0.121803 0.398884 0.004846\r\nv -0.234621 0.369233 -0.007058\r\nv -0.234621 0.369233 -0.009042\r\nv -0.290263 0.354407 -0.009042\r\nv -0.290263 0.354407 -0.007058\r\nv -0.178979 0.384058 -0.007058\r\nv -0.178979 0.384058 -0.009042\r\nv -0.178979 0.384058 0.002860\r\nv -0.178979 0.384058 0.000876\r\nv -0.234621 0.369233 0.000876\r\nv -0.234621 0.369233 0.002860\r\nv -0.290263 0.354407 0.000876\r\nv -0.290263 0.354407 0.002860\r\nv -0.345905 0.339581 -0.011026\r\nv -0.123337 0.398884 -0.011026\r\nv -0.345905 0.339581 0.004841\r\nv -0.123337 0.398884 0.004844\r\nv -0.411431 0.241271 -0.003091\r\nv -0.411432 0.241271 0.000876\r\nv -0.378668 0.290426 0.000877\r\nv -0.378668 0.290426 -0.003091\r\nv -0.411431 0.241271 -0.007058\r\nv -0.378668 0.290426 -0.007058\r\nv -0.444195 0.192115 -0.003091\r\nv -0.444195 0.192115 0.000876\r\nv -0.444195 0.192115 -0.007058\r\nv -0.345905 0.339581 0.004841\r\nv -0.476958 0.142960 0.004844\r\nv -0.345905 0.339581 -0.011026\r\nv -0.476958 0.142960 -0.011026\r\nv 0.344371 0.339581 0.004841\r\nv 0.231823 0.181390 0.151262\r\nv 0.475424 0.142960 0.004843\r\nv 0.174657 0.283588 0.094743\r\nv 0.344371 0.339581 0.004841\r\nv 0.121803 0.398884 0.004846\r\nv 0.231823 0.181390 0.151262\r\nv 0.344371 0.339581 0.004841\r\nv 0.174657 0.283588 0.094743\r\nv 0.105320 0.175936 0.192259\r\nv 0.200619 0.102810 0.192259\r\nv 0.231823 0.181390 0.151262\r\nv 0.105320 0.175936 0.192259\r\nv 0.200619 0.102810 0.192259\r\nv 0.475424 0.142960 0.004843\r\nv 0.231823 0.181390 0.151262\r\nv 0.242338 0.002092 0.192259\r\nv 0.174657 0.283588 0.094743\r\nv -0.000749 0.298278 0.102578\r\nv 0.105320 0.175936 0.192259\r\nv 0.121803 0.398884 0.004846\r\nv -0.000749 0.298278 0.102578\r\nv -0.106854 0.175936 0.192259\r\nv 0.105320 0.175936 0.192259\r\nv 0.475424 -0.138776 0.004843\r\nv 0.475424 0.142960 0.004843\r\nv 0.242338 0.002092 0.192259\r\nv -0.202154 0.102810 0.192259\r\nv -0.243872 0.002092 0.192259\r\nv 0.242338 0.002092 0.192259\r\nv 0.200619 0.102810 0.192259\r\nv -0.202154 -0.098626 0.192259\r\nv 0.200619 -0.098626 0.192259\r\nv 0.105320 -0.171752 0.192259\r\nv -0.106854 -0.171752 0.192259\r\nv -0.106854 0.175936 0.192259\r\nv 0.105320 0.175936 0.192259\r\nv -0.000749 0.298278 0.102578\r\nv 0.121803 0.398884 0.004846\r\nv -0.123337 0.398884 0.004844\r\nv -0.345905 0.339581 0.004841\r\nv -0.476958 0.142960 0.004844\r\nv -0.233357 0.181390 0.151262\r\nv -0.176191 0.283588 0.094743\r\nv -0.123337 0.398884 0.004844\r\nv -0.345905 0.339581 0.004841\r\nv -0.233357 0.181390 0.151262\r\nv -0.176191 0.283588 0.094743\r\nv -0.345905 0.339581 0.004841\r\nv -0.106854 0.175936 0.192259\r\nv -0.202154 0.102810 0.192259\r\nv -0.106854 0.175936 0.192259\r\nv -0.233357 0.181390 0.151262\r\nv -0.202154 0.102810 0.192259\r\nv -0.233357 0.181390 0.151262\r\nv -0.476958 0.142960 0.004844\r\nv -0.243872 0.002092 0.192259\r\nv -0.176191 0.283588 0.094743\r\nv -0.106854 0.175936 0.192259\r\nv -0.000749 0.298278 0.102578\r\nv -0.123337 0.398884 0.004844\r\nv -0.476958 -0.138776 0.004844\r\nv -0.243872 0.002092 0.192259\r\nv -0.476958 0.142960 0.004844\r\nv 0.344371 -0.335396 0.004841\r\nv 0.475424 -0.138776 0.004843\r\nv 0.231823 -0.177206 0.151262\r\nv 0.174657 -0.279404 0.094742\r\nv 0.121803 -0.394700 0.004845\r\nv 0.344371 -0.335396 0.004841\r\nv 0.231823 -0.177206 0.151262\r\nv 0.174657 -0.279404 0.094742\r\nv 0.344371 -0.335396 0.004841\r\nv 0.105320 -0.171752 0.192259\r\nv 0.200619 -0.098626 0.192259\r\nv 0.105320 -0.171752 0.192259\r\nv 0.231823 -0.177206 0.151262\r\nv 0.200619 -0.098626 0.192259\r\nv 0.231823 -0.177206 0.151262\r\nv 0.475424 -0.138776 0.004843\r\nv 0.242338 0.002092 0.192259\r\nv 0.174657 -0.279404 0.094742\r\nv 0.105320 -0.171752 0.192259\r\nv -0.000749 -0.294094 0.102578\r\nv 0.121803 -0.394700 0.004845\r\nv -0.000749 -0.294094 0.102578\r\nv 0.105320 -0.171752 0.192259\r\nv -0.106854 -0.171752 0.192259\r\nv -0.000749 -0.294094 0.102578\r\nv -0.123337 -0.394700 0.004844\r\nv 0.121803 -0.394700 0.004845\r\nv -0.345905 -0.335396 0.004841\r\nv -0.233357 -0.177206 0.151262\r\nv -0.476958 -0.138776 0.004844\r\nv -0.176191 -0.279404 0.094742\r\nv -0.345905 -0.335396 0.004841\r\nv -0.123337 -0.394700 0.004844\r\nv -0.233357 -0.177206 0.151262\r\nv -0.345905 -0.335396 0.004841\r\nv -0.176191 -0.279404 0.094742\r\nv -0.106854 -0.171752 0.192259\r\nv -0.202154 -0.098626 0.192259\r\nv -0.233357 -0.177206 0.151262\r\nv -0.106854 -0.171752 0.192259\r\nv -0.202154 -0.098626 0.192259\r\nv -0.476958 -0.138776 0.004844\r\nv -0.233357 -0.177206 0.151262\r\nv -0.243872 0.002092 0.192259\r\nv -0.176191 -0.279404 0.094742\r\nv -0.000749 -0.294094 0.102578\r\nv -0.106854 -0.171752 0.192259\r\nv -0.123337 -0.394700 0.004844\r\nv -0.088103 0.002092 -0.367170\r\nv -0.345905 0.339581 -0.011026\r\nv -0.242792 0.326492 -0.055780\r\nv -0.000767 0.002092 -0.396193\r\nv -0.242792 0.326492 -0.055780\r\nv -0.345905 0.339581 -0.011026\r\nv -0.123337 0.398884 -0.011026\r\nv -0.000761 0.318330 -0.106800\r\nv -0.242792 0.326492 -0.055780\r\nv -0.123337 0.398884 -0.011026\r\nv -0.000767 0.002092 -0.396193\r\nv 0.121803 0.398884 -0.011026\r\nv -0.000761 0.318330 -0.106800\r\nv -0.123337 0.398884 -0.011026\r\nv 0.475424 0.142960 -0.011026\r\nv 0.238249 0.002079 -0.246334\r\nv 0.086569 0.002092 -0.367170\r\nv 0.376664 0.157180 -0.085035\r\nv 0.376664 0.157180 -0.085035\r\nv 0.086569 0.002092 -0.367170\r\nv 0.344371 0.339581 -0.011026\r\nv -0.000767 0.002092 -0.396193\r\nv 0.241258 0.326492 -0.055780\r\nv 0.344371 0.339581 -0.011026\r\nv 0.086569 0.002092 -0.367170\r\nv 0.241258 0.326492 -0.055780\r\nv 0.121803 0.398884 -0.011026\r\nv 0.344371 0.339581 -0.011026\r\nv -0.000761 0.318330 -0.106800\r\nv 0.121803 0.398884 -0.011026\r\nv 0.241258 0.326492 -0.055780\r\nv -0.000767 0.002092 -0.396193\r\nv -0.476958 -0.138776 -0.011026\r\nv -0.239783 0.002079 -0.246334\r\nv -0.088103 0.002092 -0.367170\r\nv -0.378198 -0.152996 -0.085035\r\nv -0.378198 -0.152996 -0.085035\r\nv -0.088103 0.002092 -0.367170\r\nv -0.345905 -0.335396 -0.011026\r\nv -0.000767 0.002092 -0.396193\r\nv -0.242792 -0.322308 -0.055780\r\nv -0.345905 -0.335396 -0.011026\r\nv -0.088103 0.002092 -0.367170\r\nv -0.242792 -0.322308 -0.055780\r\nv -0.123337 -0.394700 -0.011026\r\nv -0.345905 -0.335396 -0.011026\r\nv -0.000761 -0.314146 -0.106800\r\nv -0.123337 -0.394700 -0.011026\r\nv -0.242792 -0.322308 -0.055780\r\nv -0.000767 0.002092 -0.396193\r\nv 0.475424 -0.138776 -0.011026\r\nv 0.086569 0.002092 -0.367170\r\nv 0.238249 0.002079 -0.246334\r\nv 0.376664 -0.152996 -0.085035\r\nv 0.376664 -0.152996 -0.085035\r\nv 0.344371 -0.335396 -0.011026\r\nv 0.086569 0.002092 -0.367170\r\nv 0.086569 0.002092 -0.367170\r\nv 0.344371 -0.335396 -0.011026\r\nv 0.241258 -0.322308 -0.055780\r\nv -0.000767 0.002092 -0.396193\r\nv 0.241258 -0.322308 -0.055780\r\nv 0.344371 -0.335396 -0.011026\r\nv 0.121803 -0.394700 -0.011026\r\nv -0.000761 -0.314146 -0.106800\r\nv 0.241258 -0.322308 -0.055780\r\nv 0.121803 -0.394700 -0.011026\r\nv -0.000767 0.002092 -0.396193\r\nv 0.121803 -0.394700 -0.011026\r\nv -0.123337 -0.394700 -0.011026\r\nv -0.000761 -0.314146 -0.106800\r\nv 0.475424 0.142960 -0.011026\r\nv 0.475424 -0.138776 -0.011026\r\nv 0.238249 0.002079 -0.246334\r\nv -0.476958 0.142960 -0.011026\r\nv -0.088103 0.002092 -0.367170\r\nv -0.239783 0.002079 -0.246334\r\nv -0.378198 0.157180 -0.085035\r\nv -0.476958 0.142960 -0.011026\r\nv -0.239783 0.002079 -0.246334\r\nv -0.476958 -0.138776 -0.011026\r\nv -0.378198 0.157180 -0.085035\r\nv -0.345905 0.339581 -0.011026\r\nv -0.088103 0.002092 -0.367170\r\nv -0.378198 0.157180 -0.085035\r\nv -0.476958 0.142960 -0.011026\r\nv -0.345905 0.339581 -0.011026\r\nv -0.378198 -0.152996 -0.085035\r\nv -0.345905 -0.335396 -0.011026\r\nv -0.476958 -0.138776 -0.011026\r\nv 0.376664 -0.152996 -0.085035\r\nv 0.475424 -0.138776 -0.011026\r\nv 0.344371 -0.335396 -0.011026\r\nv 0.376664 0.157180 -0.085035\r\nv 0.344371 0.339581 -0.011026\r\nv 0.475424 0.142960 -0.011026\r\n\r\nf 1 2 3 4\r\nf 5 6 7 8\r\nf 9 10 6 5\r\nf 11 5 8 12\r\nf 13 9 5 11\r\nf 7 14 8\r\nf 15 8 14\r\nf 6 14 7\r\nf 10 16 6\r\nf 14 6 16\r\nf 9 16 10\r\nf 11 12 15\r\nf 8 15 12\r\nf 17 11 15\r\nf 17 9 13\r\nf 11 17 13\r\nf 16 9 17\r\nf 18 19 20 21\r\nf 22 18 21 23\r\nf 24 25 26 27\r\nf 25 28 29 26\r\nf 19 30 20\r\nf 21 20 30\r\nf 21 30 31\r\nf 19 29 32 30\r\nf 28 32 29\r\nf 18 26 29 19\r\nf 25 32 28\r\nf 26 18 22 27\r\nf 23 31 22\r\nf 31 23 21\r\nf 31 33 27 22\r\nf 25 24 33\r\nf 27 33 24\r\nf 32 25 33\r\nf 34 35 36 37\r\nf 38 34 37 39\r\nf 40 41 42 43\r\nf 41 44 45 42\r\nf 35 46 36\r\nf 37 36 46\r\nf 37 46 47\r\nf 35 45 48 46\r\nf 44 48 45\r\nf 34 42 45 35\r\nf 41 48 44\r\nf 42 34 38 43\r\nf 39 47 38\r\nf 47 39 37\r\nf 47 49 43 38\r\nf 41 40 49\r\nf 43 49 40\r\nf 48 41 49\r\nf 50 51 52 53\r\nf 54 50 53 55\r\nf 56 57 58 59\r\nf 57 60 61 58\r\nf 51 62 52\r\nf 53 52 62\r\nf 53 62 63\r\nf 51 61 64 62\r\nf 60 64 61\r\nf 50 58 61 51\r\nf 57 64 60\r\nf 58 50 54 59\r\nf 55 63 54\r\nf 63 55 53\r\nf 63 65 59 54\r\nf 57 56 65\r\nf 59 65 56\r\nf 64 57 65\r\nf 66 67 68 69\r\nf 70 71 72 73\r\nf 74 75 76 77\r\nf 78 79 80 81\r\nf 82 78 81 83\r\nf 84 85 79 78\r\nf 86 84 78 82\r\nf 80 79 87\r\nf 88 87 79\r\nf 81 80 87\r\nf 83 81 89\r\nf 87 89 81\r\nf 82 83 89\r\nf 84 88 85\r\nf 79 85 88\r\nf 90 88 84\r\nf 90 86 82\r\nf 84 86 90\r\nf 89 90 82\r\nf 91 92 93 94\r\nf 95 96 92 91\r\nf 97 98 99 100\r\nf 100 99 101 102\r\nf 94 93 103\r\nf 92 103 93\r\nf 92 104 103\r\nf 94 103 105 101\r\nf 102 101 105\r\nf 91 94 101 99\r\nf 100 102 105\r\nf 99 98 95 91\r\nf 96 95 104\r\nf 104 92 96\r\nf 104 95 98 106\r\nf 100 106 97\r\nf 98 97 106\r\nf 105 106 100\r\nf 107 108 109 110\r\nf 111 112 108 107\r\nf 113 114 115 116\r\nf 116 115 117 118\r\nf 110 109 119\r\nf 108 119 109\r\nf 108 120 119\r\nf 110 119 121 117\r\nf 118 117 121\r\nf 107 110 117 115\r\nf 116 118 121\r\nf 115 114 111 107\r\nf 112 111 120\r\nf 120 108 112\r\nf 120 111 114 122\r\nf 116 122 113\r\nf 114 113 122\r\nf 121 122 116\r\nf 123 124 125 126\r\nf 127 123 126 128\r\nf 129 130 124 123\r\nf 131 129 123 127\r\nf 125 124 132\r\nf 133 132 124\r\nf 126 125 132\r\nf 128 126 134\r\nf 132 134 126\r\nf 127 128 134\r\nf 129 133 130\r\nf 124 130 133\r\nf 135 133 129\r\nf 135 131 127\r\nf 129 131 135\r\nf 134 135 127\r\nf 136 137 138\r\nf 139 140 141\r\nf 142 143 144\r\nf 144 145 142\r\nf 146 147 148\r\nf 149 150 151\r\nf 150 149 152\r\nf 153 154 155\r\nf 154 153 156\r\nf 157 158 159\r\nf 160 161 162\r\nf 163 164 165 166\r\nf 164 167 168 165\r\nf 169 168 167 170\r\nf 171 163 166 172\r\nf 173 174 175\r\nf 176 177 178\r\nf 179 180 181\r\nf 182 183 184\r\nf 183 182 185\r\nf 186 187 188\r\nf 189 190 191\r\nf 191 192 189\r\nf 193 194 195\r\nf 195 196 193\r\nf 197 198 199\r\nf 200 201 202\r\nf 203 204 205\r\nf 206 207 208\r\nf 207 206 209\r\nf 210 211 212\r\nf 213 214 215\r\nf 215 216 213\r\nf 217 218 219\r\nf 219 220 217\r\nf 221 222 223\r\nf 224 225 226\r\nf 227 228 229\r\nf 230 231 232\r\nf 233 234 235\r\nf 235 236 233\r\nf 237 238 239\r\nf 240 241 242\r\nf 241 240 243\r\nf 244 245 246\r\nf 245 244 247\r\nf 248 249 250\r\nf 250 251 248\r\nf 252 253 254\r\nf 255 256 257\r\nf 256 255 258\r\nf 259 260 261\r\nf 262 263 264\r\nf 264 265 262\r\nf 266 267 268\r\nf 269 270 271\r\nf 271 272 269\r\nf 273 274 275\r\nf 276 277 278\r\nf 278 279 276\r\nf 280 281 282\r\nf 282 283 280\r\nf 284 285 286\r\nf 287 288 289\r\nf 289 290 287\r\nf 291 292 293\r\nf 294 295 296\r\nf 296 297 294\r\nf 298 299 300\r\nf 299 298 301\r\nf 302 303 304\r\nf 305 306 307\r\nf 307 308 305\r\nf 309 310 311\r\nf 312 313 314\r\nf 313 312 315\r\nf 316 317 318\r\nf 319 320 321\r\nf 322 323 324\r\nf 323 322 325\r\nf 326 327 328\r\nf 329 330 331\r\nf 332 333 334\r\nf 335 336 337\r\nf 338 339 340\r\nf 341 342 343\r\n"},686:function(r){r.exports="v -0.207940 0.539000 -0.035637\nv -0.207940 0.539000 -0.051709\nv 0.207940 0.539000 -0.051709\nv 0.207940 0.539000 -0.035637\nv 0.207940 -0.539000 -0.035637\nv 0.207940 -0.539000 -0.051709\nv -0.207940 -0.539000 -0.051709\nv -0.207940 -0.539000 -0.035637\nv 0.303020 -0.108337 -0.179044\nv 0.431198 0.000000 -0.051713\nv 0.303020 0.108337 -0.179044\nv 0.230331 0.000006 -0.251252\nv -0.303020 0.108337 -0.179044\nv -0.431198 0.000000 -0.051713\nv -0.303020 -0.108337 -0.179044\nv -0.230331 -0.000006 -0.251252\nv 0.206455 0.341486 -0.179032\nv 0.206455 -0.341486 -0.179032\nv -0.206455 -0.341486 -0.179032\nv -0.206455 0.341486 -0.179032\nv 0.431198 0.000000 -0.035634\nv -0.431198 0.000000 -0.035634\nv -0.000004 0.466408 -0.171810\nv 0.000004 -0.466408 -0.171810\nv 0.059270 0.314067 -0.290746\nv 0.059272 -0.314067 -0.290746\nv -0.059270 -0.314067 -0.290746\nv -0.059272 0.314067 -0.290746\nv 0.000000 0.192723 -0.385482\nv 0.000000 -0.192723 -0.385482\nv 0.000000 0.149550 -0.404954\nv 0.133978 0.190507 -0.296047\nv 0.000000 -0.149550 -0.404954\nv 0.133978 -0.190507 -0.296047\nv -0.133978 -0.190507 -0.296047\nv -0.133978 0.190507 -0.296047\nv 0.000000 0.000000 -0.427748\nv 0.165869 0.454023 0.053598\nv -0.165869 -0.454023 0.053598\nv -0.173827 -0.196178 0.167748\nv -0.160416 -0.250866 0.157075\nv -0.151876 -0.318404 0.134631\nv -0.150388 -0.357024 0.117875\nv -0.152713 -0.390543 0.099157\nv -0.311234 0.082893 0.142559\nv -0.243867 -0.027085 0.167748\nv 0.173827 0.196178 0.167748\nv 0.160416 0.250866 0.157075\nv 0.151876 0.318404 0.134631\nv 0.150388 0.357024 0.117875\nv 0.152713 0.390543 0.099157\nv 0.311234 -0.082893 0.142559\nv 0.243867 0.027085 0.167748\nv -0.295571 0.128072 0.136208\nv -0.211790 0.479198 0.007899\nv -0.223016 0.404472 0.048949\nv -0.241579 0.320854 0.082395\nv 0.295571 -0.128072 0.136208\nv 0.211790 -0.479198 0.007899\nv 0.223016 -0.404472 0.048949\nv 0.241579 -0.320854 0.082395\nf 1 3 2\nf 1 4 3\nf 5 7 6\nf 5 8 7\nf 9 11 10\nf 9 12 11\nf 13 15 14\nf 13 16 15\nf 11 3 10\nf 11 17 3\nf 9 6 18\nf 9 10 6\nf 15 7 14\nf 15 19 7\nf 13 2 20\nf 13 14 2\nf 21 3 4\nf 21 10 3\nf 5 10 21\nf 5 6 10\nf 22 7 8\nf 22 14 7\nf 1 14 22\nf 1 2 14\nf 23 2 3\nf 24 6 7\nf 25 23 3\nf 26 6 24\nf 27 24 7\nf 28 2 23\nf 17 25 3\nf 18 6 26\nf 19 27 7\nf 20 2 28\nf 28 25 29\nf 28 23 25\nf 26 27 30\nf 26 24 27\nf 31 17 32\nf 31 25 17\nf 31 29 25\nf 33 26 30\nf 33 18 26\nf 33 34 18\nf 33 19 35\nf 33 27 19\nf 33 30 27\nf 31 28 29\nf 31 20 28\nf 31 36 20\nf 11 32 17\nf 34 9 18\nf 15 35 19\nf 36 13 20\nf 37 11 12\nf 37 32 11\nf 37 31 32\nf 9 37 12\nf 9 33 37\nf 9 34 33\nf 33 16 37\nf 33 15 16\nf 33 35 15\nf 37 36 31\nf 37 13 36\nf 37 16 13\nf 1 38 4\nf 5 39 8\nf 40 42 41\nf 40 43 42\nf 40 44 43\nf 40 39 44\nf 40 8 39\nf 40 22 8\nf 40 45 22\nf 40 46 45\nf 47 49 48\nf 47 50 49\nf 47 51 50\nf 47 38 51\nf 47 4 38\nf 47 21 4\nf 47 52 21\nf 47 53 52\nf 54 22 45\nf 54 1 22\nf 54 55 1\nf 54 56 55\nf 54 57 56\nf 58 21 52\nf 58 5 21\nf 58 59 5\nf 58 60 59\nf 58 61 60\nf 55 38 1\nf 55 51 38\nf 59 39 5\nf 59 44 39\nf 56 51 55\nf 56 50 51\nf 60 44 59\nf 60 43 44\nf 57 50 56\nf 57 49 50\nf 61 43 60\nf 61 42 43\nf 54 49 57\nf 54 48 49\nf 58 42 61\nf 58 41 42\nf 46 54 45\nf 46 48 54\nf 46 47 48\nf 53 58 52\nf 53 41 58\nf 53 40 41\nf 40 47 46\nf 40 53 47"},640:function(r){r.exports="v -0.000000 0.075784 -0.362062\nv 0.419974 0.419975 0.067760\nv 0.000000 0.000000 -0.421145\nv 0.075784 0.000000 -0.362062\nv 0.419975 -0.419974 0.067760\nv 0.000000 -0.075784 -0.362062\nv -0.419974 -0.419975 0.067760\nv -0.075784 -0.000000 -0.362062\nv -0.419975 0.419974 0.067760\nv -0.420000 0.419993 0.077606\nv 0.420000 0.419993 0.077606\nv 0.419993 -0.420000 0.077606\nv -0.420000 -0.419993 0.077606\nv 0.000007 0.335496 -0.082200\nv 0.335496 -0.000007 -0.082200\nv -0.000007 -0.335496 -0.082200\nv -0.335496 0.000007 -0.082200\nv 0.000002 0.251853 -0.194175\nv 0.251853 -0.000002 -0.194175\nv -0.000002 -0.251853 -0.194175\nv -0.251853 0.000002 -0.194175\nv 0.000001 0.173177 -0.276060\nv 0.173177 -0.000001 -0.276060\nv -0.000001 -0.173177 -0.276060\nv -0.173177 0.000001 -0.276060\nv -0.000008 0.303736 0.221142\nv -0.303736 -0.000008 0.220917\nv 0.000008 -0.303736 0.221142\nv 0.303736 0.000008 0.220917\nv -0.276097 0.310598 0.196185\nv -0.310597 0.276097 0.196186\nv -0.310597 -0.276099 0.196186\nv -0.276095 -0.310597 0.196186\nv 0.276100 -0.310597 0.196186\nv 0.310598 -0.276095 0.196186\nv 0.310598 0.276100 0.196185\nv 0.276095 0.310598 0.196186\nv -0.268060 0.268054 0.221143\nv -0.268058 -0.268057 0.221142\nv 0.268057 -0.268058 0.221142\nv 0.268059 0.268057 0.221142\nf 1 2 3\nf 2 4 3\nf 4 5 3\nf 5 6 3\nf 7 3 6\nf 8 3 7\nf 8 9 3\nf 9 1 3\nf 10 2 9\nf 10 11 2\nf 12 2 11\nf 12 5 2\nf 13 5 12\nf 13 7 5\nf 13 9 7\nf 13 10 9\nf 9 2 14\nf 2 5 15\nf 7 16 5\nf 7 9 17\nf 2 18 14\nf 2 15 19\nf 5 19 15\nf 5 16 20\nf 7 20 16\nf 7 17 21\nf 9 21 17\nf 9 14 18\nf 22 18 2\nf 2 19 23\nf 23 19 5\nf 5 20 24\nf 7 24 20\nf 25 7 21\nf 25 21 9\nf 9 18 22\nf 22 2 1\nf 2 23 4\nf 4 23 5\nf 5 24 6\nf 7 6 24\nf 7 25 8\nf 8 25 9\nf 9 22 1\nf 26 11 10\nf 27 10 13\nf 28 13 12\nf 29 12 11\nf 26 10 30\nf 27 31 10\nf 27 13 32\nf 28 33 13\nf 28 12 34\nf 29 35 12\nf 36 29 11\nf 26 37 11\nf 38 30 10\nf 31 38 10\nf 39 32 13\nf 39 13 33\nf 40 34 12\nf 40 12 35\nf 41 36 11\nf 41 11 37\nf 38 26 30\nf 38 31 27\nf 27 32 39\nf 28 39 33\nf 40 28 34\nf 29 40 35\nf 41 29 36\nf 26 41 37\nf 38 41 26\nf 38 29 41\nf 38 40 29\nf 38 28 40\nf 38 39 28\nf 38 27 39"},418:function(r){r.exports="v 0.000000 -0.474949 0.000000\r\nv 0.343677 -0.212407 0.249693\r\nv -0.131270 -0.212407 0.404015\r\nv -0.424807 -0.212405 0.000000\r\nv -0.131270 -0.212407 -0.404015\r\nv 0.343677 -0.212407 -0.249693\r\nv 0.131270 0.212407 0.404015\r\nv -0.343677 0.212407 0.249693\r\nv -0.343677 0.212407 -0.249693\r\nv 0.131270 0.212407 -0.404015\r\nv 0.424807 0.212405 0.000000\r\nv 0.000000 0.474949 0.000000\r\nv -0.077158 -0.404018 0.237472\r\nv 0.202007 -0.404018 0.146765\r\nv 0.124849 -0.249699 0.384240\r\nv 0.404015 -0.249698 0.000000\r\nv 0.202007 -0.404018 -0.146765\r\nv -0.249695 -0.404016 0.000000\r\nv -0.326855 -0.249698 0.237473\r\nv -0.077158 -0.404018 -0.237472\r\nv -0.326855 -0.249698 -0.237473\r\nv 0.124849 -0.249699 -0.384240\r\nv 0.451704 0.000000 0.146765\r\nv 0.451704 0.000000 -0.146765\r\nv 0.000000 0.000000 0.474949\r\nv 0.279168 0.000000 0.384242\r\nv -0.451704 0.000000 0.146765\r\nv -0.279168 0.000000 0.384242\r\nv -0.279168 0.000000 -0.384242\r\nv -0.451704 0.000000 -0.146765\r\nv 0.279168 0.000000 -0.384242\r\nv 0.000000 0.000000 -0.474949\r\nv 0.326855 0.249698 0.237473\r\nv -0.124849 0.249699 0.384240\r\nv -0.404015 0.249698 0.000000\r\nv -0.124849 0.249699 -0.384240\r\nv 0.326855 0.249698 -0.237473\r\nv 0.077158 0.404018 0.237472\r\nv 0.249695 0.404016 0.000000\r\nv -0.202007 0.404018 0.146765\r\nv -0.202007 0.404018 -0.146765\r\nv 0.077158 0.404018 -0.237472\r\n\r\nf 1 14 13\r\nf 2 14 16\r\nf 1 13 18\r\nf 1 18 20\r\nf 1 20 17\r\nf 2 16 23\r\nf 3 15 25\r\nf 4 19 27\r\nf 5 21 29\r\nf 6 22 31\r\nf 2 23 26\r\nf 3 25 28\r\nf 4 27 30\r\nf 5 29 32\r\nf 6 31 24\r\nf 7 33 38\r\nf 8 34 40\r\nf 9 35 41\r\nf 10 36 42\r\nf 11 37 39\r\nf 39 42 12\r\nf 39 37 42\r\nf 37 10 42\r\nf 42 41 12\r\nf 42 36 41\r\nf 36 9 41\r\nf 41 40 12\r\nf 41 35 40\r\nf 35 8 40\r\nf 40 38 12\r\nf 40 34 38\r\nf 34 7 38\r\nf 38 39 12\r\nf 38 33 39\r\nf 33 11 39\r\nf 24 37 11\r\nf 24 31 37\r\nf 31 10 37\r\nf 32 36 10\r\nf 32 29 36\r\nf 29 9 36\r\nf 30 35 9\r\nf 30 27 35\r\nf 27 8 35\r\nf 28 34 8\r\nf 28 25 34\r\nf 25 7 34\r\nf 26 33 7\r\nf 26 23 33\r\nf 23 11 33\r\nf 31 32 10\r\nf 31 22 32\r\nf 22 5 32\r\nf 29 30 9\r\nf 29 21 30\r\nf 21 4 30\r\nf 27 28 8\r\nf 27 19 28\r\nf 19 3 28\r\nf 25 26 7\r\nf 25 15 26\r\nf 15 2 26\r\nf 23 24 11\r\nf 23 16 24\r\nf 16 6 24\r\nf 17 22 6\r\nf 17 20 22\r\nf 20 5 22\r\nf 20 21 5\r\nf 20 18 21\r\nf 18 4 21\r\nf 18 19 4\r\nf 18 13 19\r\nf 13 3 19\r\nf 16 17 6\r\nf 16 14 17\r\nf 14 1 17\r\nf 13 15 3\r\nf 13 14 15\r\nf 14 2 15\r\n"},298:function(r){r.exports="v -0.063637 0.245967 -0.221174\r\nv -0.125088 0.353338 -0.118588\r\nv 0.125089 0.353338 -0.118588\r\nv 0.063637 0.245967 -0.221174\r\nv -0.107604 0.200207 -0.221174\r\nv -0.211964 0.264085 -0.118588\r\nv -0.107604 -0.202698 -0.221174\r\nv -0.211964 -0.267101 -0.118588\r\nv -0.063637 -0.246910 -0.221174\r\nv -0.125088 -0.353757 -0.118588\r\nv 0.063637 -0.246910 -0.221174\r\nv 0.125089 -0.353757 -0.118588\r\nv 0.107605 -0.202698 -0.221174\r\nv 0.211964 -0.267101 -0.118588\r\nv 0.107605 0.200206 -0.221174\r\nv 0.211964 0.264085 -0.118588\r\nv -0.149805 0.396771 0.108258\r\nv 0.149805 0.396771 0.108258\r\nv 0.175550 0.443014 0.075256\r\nv -0.175549 0.443014 0.075256\r\nv -0.297342 0.317458 0.075393\r\nv -0.253558 0.291788 0.108327\r\nv -0.253566 -0.292824 0.108321\r\nv -0.297359 -0.318880 0.075381\r\nv -0.149805 -0.394576 0.108258\r\nv -0.175550 -0.440833 0.075255\r\nv 0.149805 -0.394577 0.108257\r\nv 0.175550 -0.440833 0.075255\r\nv 0.297359 -0.318880 0.075381\r\nv 0.253566 -0.292824 0.108321\r\nv 0.253558 0.291788 0.108327\r\nv 0.297343 0.317458 0.075393\r\nv 0.000000 0.134440 -0.300047\r\nv 0.000000 -0.129799 -0.300048\r\nv -0.195392 0.475646 0.030090\r\nv 0.195392 0.475646 0.030090\r\nv -0.331359 0.333823 0.030016\r\nv -0.331376 -0.335540 0.030037\r\nv -0.195395 -0.473520 0.030097\r\nv 0.195395 -0.473521 0.030097\r\nv 0.331376 -0.335540 0.030037\r\nv 0.331359 0.333823 0.030016\r\nv -0.195591 0.476155 0.043911\r\nv 0.195591 0.476155 0.043911\r\nv -0.331457 0.334257 0.044109\r\nv -0.331480 -0.336002 0.044093\r\nv -0.195590 -0.474030 0.043911\r\nv 0.195591 -0.474030 0.043911\r\nv 0.331480 -0.336002 0.044093\r\nv 0.331457 0.334257 0.044109\r\nv -0.116942 0.330342 0.139641\r\nv 0.116942 0.330342 0.139641\r\nv -0.197738 0.250765 0.139641\r\nv -0.197738 -0.251342 0.139641\r\nv -0.116942 -0.328227 0.139641\r\nv 0.116942 -0.328227 0.139641\r\nv 0.197738 -0.251342 0.139641\r\nv 0.197738 0.250765 0.139641\r\nv 0.000000 0.000608 0.139641\r\n\r\nf 1 2 3 4\r\nf 1 5 6 2\r\nf 7 8 6 5\r\nf 9 10 8 7\r\nf 11 12 10 9\r\nf 11 13 14 12\r\nf 15 16 14 13\r\nf 4 3 16 15\r\nf 17 18 19 20\r\nf 21 22 17 20\r\nf 23 22 21 24\r\nf 25 23 24 26\r\nf 27 25 26 28\r\nf 29 30 27 28\r\nf 31 30 29 32\r\nf 18 31 32 19\r\nf 1 4 33\r\nf 4 15 33\r\nf 15 13 34 33\r\nf 13 11 34\r\nf 11 9 34\r\nf 9 7 34\r\nf 7 5 33 34\r\nf 5 1 33\r\nf 35 36 3 2\r\nf 37 35 2 6\r\nf 38 37 6 8\r\nf 10 39 38 8\r\nf 40 39 10 12\r\nf 41 40 12 14\r\nf 42 41 14 16\r\nf 3 36 42 16\r\nf 35 43 44 36\r\nf 37 45 43 35\r\nf 38 46 45 37\r\nf 39 47 46 38\r\nf 40 48 47 39\r\nf 41 49 48 40\r\nf 42 50 49 41\r\nf 36 44 50 42\r\nf 51 52 18 17\r\nf 44 43 20 19\r\nf 22 53 51 17\r\nf 20 43 45 21\r\nf 54 53 22 23\r\nf 45 46 24 21\r\nf 55 54 23 25\r\nf 46 47 26 24\r\nf 56 55 25 27\r\nf 47 48 28 26\r\nf 30 57 56 27\r\nf 28 48 49 29\r\nf 58 57 30 31\r\nf 49 50 32 29\r\nf 52 58 31 18\r\nf 50 44 19 32\r\nf 55 56 59\r\nf 56 57 59\r\nf 57 58 59\r\nf 58 52 59\r\nf 52 51 59\r\nf 51 53 59\r\nf 53 54 59\r\nf 54 55 59\r\n"},692:function(r){r.exports="uniform int uLightType;\r\nuniform float uLightDirection; // 1 or -1\r\nuniform float uHeadShadow;\r\nuniform mat2 uSkyboxHorizontalCorrection;\r\n\r\nfloat sampleSkyboxMonochrome(vec3 direction) {\r\n    direction.xy = uSkyboxHorizontalCorrection * direction.xy;\r\n    direction.z *= uLightDirection;\r\n\r\n    float value;\r\n    if (uLightType == 1) { // rings\r\n        value = 0.8 * (1.0 + step(0.6, direction.z));\r\n    } else { // noise\r\n        float monoX = 0.4 + 0.6 * abs(cos(6.0 * (direction.x + 0.1)));\r\n        float monoY = 0.5 * cos(7.0 * (direction.y + 0.5 * direction.x + 0.1));\r\n        float monoZ = 0.5 * cos(5.0 * (direction.z + 0.3));\r\n        float pureMono = monoX + monoY + monoZ;\r\n\r\n        value = mix(0.7, pureMono, smoothstep(-1.0, 0.2, direction.z)); // darker below\r\n        value = 1.2 * clamp(value, 0.7, 1.5);\r\n    }\r\n\r\n    float headShadow = max(0.2, step(direction.z, uHeadShadow));\r\n    return headShadow * value;\r\n}\r\n\r\nvec3 sampleSkybox(vec3 direction) {\r\n    if (uLightType == 0) { // ASET\r\n        direction.z *= uLightDirection;\r\n        return vec3(\r\n            step(0.70, direction.z) * step(direction.z, 0.98),\r\n            step(0.0, direction.z) * step(direction.z, 0.70),\r\n            step(0.98, direction.z)\r\n        );\r\n    } else {\r\n        return vec3(sampleSkyboxMonochrome(direction));\r\n    }\r\n}"},294:function(r){r.exports="precision lowp float;\r\n\r\nvarying vec3 vNormal;\r\n\r\nvoid main(void) {\r\n    vec3 color = 0.5 + 0.5 * vNormal;\r\n    gl_FragColor = vec4(color, 1);\r\n}\r\n"},264:function(r){r.exports="precision mediump float;\r\n\r\nuniform sampler2D uTexture;\r\nuniform vec2 uTexelSize;\r\n\r\nvarying vec2 vSamplingPosition; // in [0,1]^2\r\n\r\nvec4 contribution(vec2 shiftInTexels) {\r\n    return texture2D(uTexture, vSamplingPosition + shiftInTexels * uTexelSize);\r\n}\r\n\r\nvoid main() {\r\n    vec4 blurred = vec4(0);\r\n    #INJECT(BLUR_INSTRUCTIONS)\r\n\r\n    gl_FragColor = vec4(blurred.rgb, 1);\r\n}"},709:function(r){r.exports="precision lowp float;\r\n\r\nuniform sampler2D uFullsizeTexture;\r\nuniform vec2 uFullsizeTextureTexelSize;\r\n\r\nuniform sampler2D uBlurredTexture;\r\n\r\nvarying vec2 vSamplingPosition; // in [0,1]^2\r\n\r\nfloat luminance(const vec3 rgb){\r\n    return dot(rgb, vec3(0.299, 0.587, 0.114));\r\n}\r\n\r\nvec3 fxaa(vec2 coords) {\r\n    const float THRESHOLD = 0.05;\r\n\r\n    vec3 topLeft =     texture2D(uFullsizeTexture, coords + vec2(-1,-1) * uFullsizeTextureTexelSize).rgb;\r\n    vec3 top =         texture2D(uFullsizeTexture, coords + vec2(+0,-1) * uFullsizeTextureTexelSize).rgb;\r\n    vec3 topRight =    texture2D(uFullsizeTexture, coords + vec2(+1,-1) * uFullsizeTextureTexelSize).rgb;\r\n    vec3 left =        texture2D(uFullsizeTexture, coords + vec2(-1,+0) * uFullsizeTextureTexelSize).rgb;\r\n    vec3 middle =      texture2D(uFullsizeTexture, coords).rgb;\r\n    vec3 right =       texture2D(uFullsizeTexture, coords + vec2(+1,+0) * uFullsizeTextureTexelSize).rgb;\r\n    vec3 bottomLeft =  texture2D(uFullsizeTexture, coords + vec2(-1,+1) * uFullsizeTextureTexelSize).rgb;\r\n    vec3 bottom =      texture2D(uFullsizeTexture, coords + vec2(+0,+1) * uFullsizeTextureTexelSize).rgb;\r\n    vec3 bottomRight = texture2D(uFullsizeTexture, coords + vec2(+1,+1) * uFullsizeTextureTexelSize).rgb;\r\n\r\n    float lumninance_middle = luminance(middle);           \r\n\r\n    float topLeftIsSame =     step(abs(luminance(topLeft)     - lumninance_middle), THRESHOLD);\r\n    float topIsSame =         step(abs(luminance(top)         - lumninance_middle), THRESHOLD);\r\n    float topRightIsSame =    step(abs(luminance(topRight)    - lumninance_middle), THRESHOLD);\r\n    float leftIsSame =        step(abs(luminance(left)        - lumninance_middle), THRESHOLD);\r\n    float rightIsSame =       step(abs(luminance(right)       - lumninance_middle), THRESHOLD);\r\n    float bottomLeftIsSame =  step(abs(luminance(bottomLeft)  - lumninance_middle), THRESHOLD);\r\n    float bottomIsSame =      step(abs(luminance(bottom)      - lumninance_middle), THRESHOLD);\r\n    float bottomRightIsSame = step(abs(luminance(bottomRight) - lumninance_middle), THRESHOLD);\r\n\r\n    vec2 gradient = abs(vec2(\r\n        (topLeftIsSame + leftIsSame + bottomLeftIsSame) - (topRightIsSame + rightIsSame + bottomRightIsSame),\r\n        (topLeftIsSame + topIsSame + topRightIsSame) - (bottomLeftIsSame + bottomIsSame + bottomRightIsSame)\r\n    ));\r\n\r\n    if (gradient.y > gradient.x) { // mostly horizontal edge\r\n        return 0.5 * middle + 0.25 * (left + right);\r\n    } else if (gradient.y < gradient.x) { // mostly vertical edge\r\n        return 0.5 * middle + 0.25 * (top + bottom);\r\n    }\r\n    return middle; // either no edge or perfect diagonal\r\n}\r\n\r\nvoid main() {\r\n    vec3 color = fxaa(vSamplingPosition);\r\n    vec3 glow = texture2D(uBlurredTexture, vSamplingPosition).rgb;\r\n    gl_FragColor = vec4(color + glow, 1);\r\n}"},848:function(r){r.exports="precision lowp float;\r\n\r\nuniform sampler2D uTexture;\r\n\r\nvarying vec2 vSamplingPosition; // in [0,1]^2\r\n\r\nvoid main() {\r\n    vec4 sample = texture2D(uTexture, vSamplingPosition);\r\n    vec3 color = sample.rgb * step(0.995, sample.rgb) * step(0.5, sample.a); //extract the bright parts\r\n    gl_FragColor = vec4(color, 1);\r\n}"},420:function(r){r.exports="attribute vec2 aCorner; // in {-0.5,+0.5}^2\r\n\r\nvarying vec2 vSamplingPosition; // in [0,1]^2\r\n\r\nvoid main(void) {\r\n    gl_Position = vec4(aCorner, 0, 1);\r\n    vSamplingPosition = 0.5 + 0.5 * aCorner;\r\n}\r\n"},210:function(r){r.exports="#ifdef GL_FRAGMENT_PRECISION_HIGH\r\nprecision highp float;\r\n#else\r\nprecision mediump float;\r\n#endif\r\n\r\nuniform vec3 uEyePosition;\r\nuniform float uOrthographic;\r\n\r\nvarying vec3 vPosition;\r\n\r\n#INJECT(FACETS_DEFINITION)\r\n\r\nvoid computeIntersectionWithPlane(const vec3 planePoint, const vec3 planeNormal, const vec3 startingPoint, const vec3 startingDirection, inout float currentTheta, inout vec3 currentNormal) {\r\n    float b = dot(startingDirection, planeNormal);\r\n    if (b < 0.0) { // pseudo face culling\r\n        float theta = dot(planePoint - startingPoint, planeNormal) / b;\r\n\r\n        if (theta > 0.0 && currentTheta < theta) {\r\n            currentTheta = theta;\r\n            currentNormal = planeNormal;\r\n        }\r\n    }\r\n}\r\n\r\nbool isInside(const vec3 planePoint, const vec3 planeNormal, const vec3 position) {\r\n    return dot(planePoint - position, planeNormal) >= -0.00001;\r\n}\r\n\r\nbool computeEntryPoint(const vec3 eyePosition, const vec3 fromEyeNormalized, out vec3 entryPoint, out vec3 facetNormal) {\r\n    float theta = -1.0;\r\n\r\n    #INJECT(COMPUTE_ENTRY_POINT)\r\n\r\n    entryPoint = uEyePosition + theta * fromEyeNormalized;\r\n    bool onGem = #INJECT(CHECK_IF_INSIDE);\r\n    return onGem;\r\n}\r\n\r\nvoid main(void) {\r\n    vec3 fromEyeNormalized = normalize(mix(vPosition - uEyePosition, -uEyePosition, uOrthographic));\r\n\r\n    vec3 entryPoint;\r\n    vec3 entryFacetNormal;\r\n    bool intersectionWithGem = computeEntryPoint(uEyePosition, fromEyeNormalized, entryPoint, entryFacetNormal);\r\n    vec3 normalAsColor = vec3(0.5 + 0.5 * entryFacetNormal);\r\n    \r\n    // no intersection with the gem, draw the cube edges\r\n    vec3 edge = step(0.9, abs(vPosition));\r\n    bool isOnEdge = (edge.x + edge.y + edge.z) > 1.5;\r\n    if (!isOnEdge && !intersectionWithGem) {\r\n        discard;\r\n    }\r\n    const vec3 cubeEdgeColor = vec3(1, 0, 0);\r\n\r\n    vec3 color = intersectionWithGem ? normalAsColor: cubeEdgeColor;\r\n    gl_FragColor = vec4(color, 1);\r\n}\r\n"},399:function(r){r.exports="attribute vec3 aPosition; // in [-0.5,+0.5]^3\r\n\r\nuniform mat4 uMVPMatrix;\r\n\r\nvarying vec3 vPosition; // in [-0.5,+0.5]^3\r\n\r\nvoid main(void) {\r\n    vec3 scaledPosition = 2.0 * aPosition;\r\n\r\n    gl_Position = uMVPMatrix * vec4(scaledPosition, 1.0);\r\n    vPosition = scaledPosition;\r\n}\r\n"},176:function(r){r.exports='#ifdef GL_FRAGMENT_PRECISION_HIGH\r\nprecision highp float;\r\n#else\r\nprecision mediump float;\r\n#endif\r\n\r\nuniform vec3 uEyePosition;\r\nuniform float uOrthographic;\r\nuniform vec3 uAbsorption;\r\nuniform float uDisplayReflection;\r\nuniform vec3 uRefractionIndices;\r\n\r\nvarying vec3 vPosition;\r\nvarying vec3 vNormal;\r\n\r\nconst int rayDepth = #INJECT(RAY_DEPTH);\r\n\r\n#INJECT(FACETS_DEFINITION)\r\n\r\n#include "_skybox.frag"\r\n\r\nfloat checkNextInternalIntersection(const vec3 planePoint, const vec3 planeNormal, const vec3 position, const vec3 direction, inout float theta, inout vec3 facetNormal) {\r\n    float b = dot(direction, planeNormal);\r\n    if (b > 0.0) {\r\n        float localTheta = dot(planePoint - position, planeNormal) / b;\r\n\r\n        if (localTheta < theta) {\r\n            facetNormal = planeNormal;\r\n            theta = localTheta;\r\n        }\r\n    }\r\n    return theta;\r\n}\r\n\r\nfloat computeInternalIntersection(const vec3 position, const vec3 direction, inout vec3 facetNormal) {\r\n    float theta = 100000.0;\r\n    #INJECT(COMPUTE_INTERNAL_INTERSECTION)\r\n    return theta;\r\n}\r\n\r\n/** @param eta              refraction_index_current / refraction_index_other\r\n *  @param surfaceNormal    facing the incidentRay\r\n */\r\nfloat computeFresnelReflection(const vec3 incidentRay, const vec3 surfaceNormal, const vec3 refractedRay, const float eta, const float cosCriticalAngle) {\r\n    float cosIncident = abs(dot(surfaceNormal, incidentRay));\r\n\r\n    if (cosIncident < cosCriticalAngle) {\r\n        return 1.0;\r\n    }\r\n\r\n    float cosRefracted = abs(dot(surfaceNormal, refractedRay));\r\n    float etaCosRefracted = eta * cosRefracted;\r\n    float etaCosIncident = eta * cosIncident;\r\n\r\n    float a = (cosIncident - etaCosRefracted) / (cosIncident + etaCosRefracted);\r\n    float b = (etaCosIncident - cosRefracted) / (etaCosIncident + cosRefracted);\r\n    return 0.5 * (a * a + b * b);\r\n}\r\n\r\nfloat computeDiamondColor(vec3 currentPoint, vec3 currentDirection, vec3 currentFacetNormal, const float refractionIndex, const float absorption) {\r\n    float etaExitingGem = refractionIndex;\r\n    float cosCriticalAngleExitingGem = sqrt(max(0.0, 1.0 - 1.0 / (refractionIndex * refractionIndex)));\r\n\r\n    float cumulatedColor = 0.0;\r\n    float rayStrength = 1.0;\r\n    float totalDepthInside = 0.0;\r\n\r\n    for (int i = 0; i < rayDepth; i++) {\r\n        float theta = computeInternalIntersection(currentPoint, currentDirection, currentFacetNormal);\r\n        vec3 refractedRay = refract(currentDirection, -currentFacetNormal, etaExitingGem);\r\n        float fresnelReflection = computeFresnelReflection(currentDirection, -currentFacetNormal, refractedRay, etaExitingGem, cosCriticalAngleExitingGem);\r\n    \r\n        totalDepthInside += theta;\r\n        cumulatedColor += rayStrength * (1.0 - fresnelReflection) * sampleSkyboxMonochrome(refractedRay) * exp(-absorption * totalDepthInside);\r\n        rayStrength *= fresnelReflection;\r\n\r\n        if (rayStrength < 0.001) {\r\n            return cumulatedColor;\r\n        }\r\n        currentPoint += theta * currentDirection;\r\n        currentDirection = reflect(currentDirection, -currentFacetNormal);\r\n    }\r\n    cumulatedColor += rayStrength * 0.5 * sampleSkyboxMonochrome(currentDirection) * exp(-absorption * totalDepthInside);\r\n\r\n    return cumulatedColor;\r\n}\r\n\r\nvoid main(void) {\r\n    vec3 fromEyeNormalized = normalize(mix(vPosition - uEyePosition, -uEyePosition, uOrthographic));\r\n\r\n    vec3 etaEnteringGem = 1.0 / uRefractionIndices;\r\n    vec3 cosCriticalAngleEnteringGem = sqrt(max(vec3(0), vec3(1) - uRefractionIndices * uRefractionIndices));\r\n\r\n    vec3 entryPoint = vPosition;\r\n    vec3 entryFacetNormal = vNormal;\r\n\r\n    vec3 entryDirectionRed = refract(fromEyeNormalized, entryFacetNormal, etaEnteringGem.r);\r\n    vec3 entryDirectionGreen = refract(fromEyeNormalized, entryFacetNormal, etaEnteringGem.g);\r\n    vec3 entryDirectionBlue = refract(fromEyeNormalized, entryFacetNormal, etaEnteringGem.b);\r\n\r\n    vec3 diamondColor = vec3(\r\n        computeDiamondColor(entryPoint, entryDirectionRed, entryFacetNormal, uRefractionIndices.r, uAbsorption.r),\r\n        computeDiamondColor(entryPoint, entryDirectionGreen, entryFacetNormal, uRefractionIndices.g, uAbsorption.g),\r\n        computeDiamondColor(entryPoint, entryDirectionBlue, entryFacetNormal, uRefractionIndices.b, uAbsorption.b)\r\n    );\r\n\r\n    vec3 reflectedRay = reflect(fromEyeNormalized, entryFacetNormal);\r\n    vec3 reflectedColor = vec3(sampleSkyboxMonochrome(reflectedRay));\r\n\r\n    vec3 fresnelReflection = uDisplayReflection * vec3(\r\n        computeFresnelReflection(fromEyeNormalized, entryFacetNormal, entryDirectionRed, etaEnteringGem.r, cosCriticalAngleEnteringGem.r),\r\n        computeFresnelReflection(fromEyeNormalized, entryFacetNormal, entryDirectionGreen, etaEnteringGem.g, cosCriticalAngleEnteringGem.g),\r\n        computeFresnelReflection(fromEyeNormalized, entryFacetNormal, entryDirectionBlue, etaEnteringGem.b, cosCriticalAngleEnteringGem.b)\r\n    );\r\n\r\n    vec3 finalColor = mix(diamondColor, reflectedColor, fresnelReflection);\r\n    gl_FragColor = vec4(finalColor, 1);\r\n}\r\n'},765:function(r){r.exports='#ifdef GL_FRAGMENT_PRECISION_HIGH\r\nprecision highp float;\r\n#else\r\nprecision mediump float;\r\n#endif\r\n\r\nuniform vec3 uEyePosition;\r\nuniform float uOrthographic;\r\nuniform vec3 uAbsorption;\r\nuniform float uDisplayNormals;\r\nuniform float uDisplayReflection;\r\nuniform float uRefractionIndex;\r\n\r\nvarying vec3 vPosition;\r\nvarying vec3 vNormal;\r\n\r\nconst int rayDepth = #INJECT(RAY_DEPTH);\r\n\r\n#INJECT(FACETS_DEFINITION)\r\n\r\n#include "_skybox.frag"\r\n\r\nfloat checkNextInternalIntersection(const vec3 planePoint, const vec3 planeNormal, const vec3 position, const vec3 direction, inout float theta, inout vec3 facetNormal) {\r\n    float b = dot(direction, planeNormal);\r\n    if (b > 0.0) {\r\n        float localTheta = dot(planePoint - position, planeNormal) / b;\r\n\r\n        if (localTheta < theta) {\r\n            facetNormal = planeNormal;\r\n            theta = localTheta;\r\n        }\r\n    }\r\n    return theta;\r\n}\r\n\r\nfloat computeInternalIntersection(const vec3 position, const vec3 direction, inout vec3 facetNormal) {\r\n    float theta = 100000.0;\r\n    #INJECT(COMPUTE_INTERNAL_INTERSECTION)\r\n    return theta;\r\n}\r\n\r\n/** @param eta              refraction_index_current / refraction_index_other\r\n *  @param surfaceNormal    facing the incidentRay\r\n */\r\nfloat computeFresnelReflection(const vec3 incidentRay, const vec3 surfaceNormal, const vec3 refractedRay, const float eta, const float cosCriticalAngle) {\r\n    float cosIncident = abs(dot(surfaceNormal, incidentRay));\r\n\r\n    if (cosIncident < cosCriticalAngle) {\r\n        return 1.0;\r\n    }\r\n\r\n    float cosRefracted = abs(dot(surfaceNormal, refractedRay));\r\n    float etaCosRefracted = eta * cosRefracted;\r\n    float etaCosIncident = eta * cosIncident;\r\n\r\n    float a = (cosIncident - etaCosRefracted) / (cosIncident + etaCosRefracted);\r\n    float b = (etaCosIncident - cosRefracted) / (etaCosIncident + cosRefracted);\r\n    return 0.5 * (a * a + b * b);\r\n}\r\n\r\nvec3 computeDiamondColor(vec3 currentPoint, vec3 currentDirection, vec3 currentFacetNormal, const float refractionIndex) {\r\n    float etaExitingGem = refractionIndex;\r\n    float cosCriticalAngleExitingGem = sqrt(max(0.0, 1.0 - 1.0 / (refractionIndex * refractionIndex)));\r\n\r\n    vec3 cumulatedColor = vec3(0);\r\n    float rayStrength = 1.0;\r\n    float totalDepthInside = 0.0;\r\n\r\n    for (int i = 0; i < rayDepth; i++) {\r\n        float theta = computeInternalIntersection(currentPoint, currentDirection, currentFacetNormal);\r\n        vec3 refractedRay = refract(currentDirection, -currentFacetNormal, etaExitingGem);\r\n        float fresnelReflection = computeFresnelReflection(currentDirection, -currentFacetNormal, refractedRay, etaExitingGem, cosCriticalAngleExitingGem);\r\n    \r\n        totalDepthInside += theta;\r\n        cumulatedColor += rayStrength * (1.0 - fresnelReflection) * sampleSkybox(refractedRay) * exp(-uAbsorption * totalDepthInside);\r\n        rayStrength *= fresnelReflection;\r\n\r\n        currentPoint += theta * currentDirection;\r\n        currentDirection = reflect(currentDirection, -currentFacetNormal);\r\n    }\r\n    cumulatedColor += rayStrength * 0.5 * sampleSkybox(currentDirection) * exp(-uAbsorption * totalDepthInside);\r\n\r\n    vec3 lastNormalAsColor = vec3(0.5 + 0.5 * currentFacetNormal);\r\n    return mix(cumulatedColor, lastNormalAsColor, uDisplayNormals);\r\n}\r\n\r\nvoid main(void) {\r\n    vec3 fromEyeNormalized = normalize(mix(vPosition - uEyePosition, -uEyePosition, uOrthographic));\r\n\r\n    float etaEnteringGem = 1.0 / uRefractionIndex;\r\n    float cosCriticalAngleEnteringGem = sqrt(max(0.0, 1.0 - uRefractionIndex * uRefractionIndex));\r\n\r\n    vec3 entryPoint = vPosition;\r\n    vec3 entryFacetNormal = vNormal;\r\n    vec3 entryDirection = refract(fromEyeNormalized, entryFacetNormal, etaEnteringGem);\r\n\r\n    vec3 diamondColor = computeDiamondColor(entryPoint, entryDirection, entryFacetNormal, uRefractionIndex);\r\n\r\n    vec3 reflectedRay = reflect(fromEyeNormalized, entryFacetNormal);\r\n    vec3 reflectedColor = sampleSkybox(reflectedRay);\r\n\r\n    float fresnelReflection = uDisplayReflection * computeFresnelReflection(fromEyeNormalized, entryFacetNormal, entryDirection, etaEnteringGem, cosCriticalAngleEnteringGem);\r\n    vec3 finalColor = mix(diamondColor, reflectedColor, fresnelReflection);\r\n    gl_FragColor = vec4(finalColor, 1);\r\n}\r\n'},682:function(r){r.exports="attribute vec3 aPosition;\r\nattribute vec3 aNormal;\r\n\r\nuniform mat4 uMVPMatrix;\r\n\r\nvarying vec3 vPosition;\r\nvarying vec3 vNormal;\r\n\r\nvoid main(void) {\r\n    gl_Position = uMVPMatrix * vec4(aPosition, 1.0);\r\n    vPosition = aPosition;\r\n    vNormal = normalize(aNormal);\r\n}\r\n"},732:function(r){r.exports='precision lowp float;\r\n\r\nuniform vec3 uEyePosition;\r\nuniform float uOrthographic;\r\n\r\nvarying vec3 vPosition;\r\n\r\n#include "_skybox.frag"\r\n\r\nvoid main(void) {\r\n    vec3 fromEyeNormalized = normalize(mix(vPosition - uEyePosition, -uEyePosition, uOrthographic));\r\n    vec3 skybox = sampleSkybox(fromEyeNormalized);\r\n    gl_FragColor = vec4(skybox, 0.1) ;\r\n}\r\n'},368:function(r){r.exports="attribute vec3 aPosition;\r\n\r\nuniform mat4 uMVPMatrix;\r\n\r\nvarying vec3 vPosition;\r\n\r\nvoid main(void) {\r\n    vec3 scaledPosition = 20.0 * aPosition;\r\n    gl_Position = uMVPMatrix * vec4(scaledPosition, 1.0);\r\n    vPosition = scaledPosition;\r\n}\r\n"}},n={};!function e(t){var i=n[t];if(void 0!==i)return i.exports;var o=n[t]={exports:{}};return r[t].call(o.exports,o,o.exports,e),o.exports}(633)}();
//# sourceMappingURL=main.min.js.map